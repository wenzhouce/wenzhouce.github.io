<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>æ¬§æ‹‰å‡½æ•°</title>
    <url>/2024/01/31/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<h2 id="æ¨ç†è¿‡ç¨‹"><a href="#æ¨ç†è¿‡ç¨‹" class="headerlink" title="æ¨ç†è¿‡ç¨‹"></a>æ¨ç†è¿‡ç¨‹</h2><img src="/2024/01/31/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/æ¬§æ‹‰å‡½æ•°.webp" alt="æ¬§æ‹‰å‡½æ•°" style="zoom:50%;">

<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> phi[N];</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_eulers</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> tot=<span class="number">0</span>;</span><br><span class="line">    phi[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!phi[i])&#123;</span><br><span class="line">            phi[i]=i<span class="number">-1</span>;</span><br><span class="line">            pre[++tot]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=tot;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pre[j]==<span class="number">0</span>)&#123;</span><br><span class="line">                phi[i*pre[j]]=phi[i]*pre[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> phi[i*pre[j]]=phi[i]*(pre[j]<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="built_in">get_eulers</span>(n);</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        ans+=phi[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>æ•°è®º</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›®å½•</title>
    <url>/2024/01/31/%E7%9B%AE%E5%BD%95/</url>
    <content><![CDATA[<p><a href="https://wenzhouce.github.io/2024/01/31/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„ | æ´»åœ¨æ¢¦é‡Œ (wenzhouce.github.io)</a></p>
<p><a href="https://wenzhouce.github.io/2024/01/31/%E6%95%B0%E8%AE%BA/">æ•°è®º | æ´»åœ¨æ¢¦é‡Œ (wenzhouce.github.io)</a></p>
]]></content>
  </entry>
  <entry>
    <title>æ•°è®º</title>
    <url>/2024/01/31/%E6%95%B0%E8%AE%BA/</url>
    <content><![CDATA[<h1 id="è´¨æ•°"><a href="#è´¨æ•°" class="headerlink" title="è´¨æ•°"></a>è´¨æ•°</h1><h2 id="å¤æ´›å…‹å’Œä»–çš„å¥³æœ‹å‹"><a href="#å¤æ´›å…‹å’Œä»–çš„å¥³æœ‹å‹" class="headerlink" title="å¤æ´›å…‹å’Œä»–çš„å¥³æœ‹å‹"></a><a href="https://www.acwing.com/problem/content/1295/">å¤æ´›å…‹å’Œä»–çš„å¥³æœ‹å‹</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>å¤æ´›å…‹æœ‰äº†ä¸€ä¸ªæ–°å¥³å‹ï¼ˆè¿™å¤ªä¸åƒä»–äº†ï¼ï¼‰ã€‚</p>
<p>æƒ…äººèŠ‚åˆ°äº†ï¼Œä»–æƒ³é€ç»™å¥³å‹ä¸€äº›ç å®å½“åšç¤¼ç‰©ã€‚</p>
<p>ä»–ä¹°äº† n ä»¶ç å®ï¼Œç¬¬ i ä»¶çš„ä»·å€¼æ˜¯ i+1ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç å®çš„ä»·å€¼åˆ†åˆ«ä¸º 2,3,â€¦,n+1ã€‚</p>
<p>åç”ŸæŒ‘æˆ˜å¤æ´›å…‹ï¼Œè®©ä»–ç»™è¿™äº›ç å®æŸ“è‰²ï¼Œä½¿å¾—ä¸€ä»¶ç å®çš„ä»·æ ¼æ˜¯å¦ä¸€ä»¶ç å®çš„ä»·æ ¼çš„è´¨å› å­æ—¶ï¼Œä¸¤ä»¶ç å®çš„é¢œè‰²ä¸åŒã€‚</p>
<p>å¹¶ä¸”ï¼Œåç”Ÿè¦æ±‚ä»–ä½¿ç”¨çš„é¢œè‰²æ•°å°½å¯èƒ½å°‘ã€‚</p>
<p>è¯·å¸®åŠ©å¤æ´›å…‹å®Œæˆè¿™ä¸ªç®€å•çš„ä»»åŠ¡ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>å°±æ˜¯æ±‚2åˆ°n+1ä¸­çš„è´¨æ•°ï¼Œæ¬§æ‹‰ç­›</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="type">int</span> vis[N];</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n+<span class="number">1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i]=<span class="number">1</span>;</span><br><span class="line">            pre[++tot]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=tot;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            vis[pre[j]*i]=pre[j]+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pre[j]==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="built_in">init</span>(n);</span><br><span class="line">    <span class="keyword">if</span>(n&lt;<span class="number">4</span>)cout&lt;&lt;<span class="string">&quot;1\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;2\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n+<span class="number">1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(vis[i]==<span class="number">1</span>)cout&lt;&lt;<span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;2&quot;</span>;</span><br><span class="line">        cout&lt;&lt;(<span class="string">&quot;%c&quot;</span>,i==n+<span class="number">1</span>?<span class="string">&#x27;\n&#x27;</span>:<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ğ‘›-çš„ç´ å› æ•°åˆ†è§£"><a href="#ğ‘›-çš„ç´ å› æ•°åˆ†è§£" class="headerlink" title="ğ‘›!çš„ç´ å› æ•°åˆ†è§£"></a><a href="https://www.acwing.com/problem/content/199/">ğ‘›!çš„ç´ å› æ•°åˆ†è§£</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šæ•´æ•° Nï¼Œè¯•æŠŠé˜¶ä¹˜ N! åˆ†è§£è´¨å› æ•°ï¼ŒæŒ‰ç…§ç®—æœ¯åŸºæœ¬å®šç†çš„å½¢å¼è¾“å‡ºåˆ†è§£ç»“æœä¸­çš„ pi å’Œ ci å³å¯ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>æ±‚2åˆ°nä¸­æ‰€æœ‰è´¨æ•°ï¼Œå†né™¤è´¨æ•°çš„é˜¶ä¹˜ï¼ŒçŸ¥é“è´¨æ•°çš„é˜¶ä¹˜å¤§äºnï¼Œæ±‚å‡ºæ¥çš„å€¼å³ä½¿è¯¥è´¨æ•°åœ¨n!ä¸­çš„æ•°é‡</p>
<p><img src="/2024/01/31/%E6%95%B0%E8%AE%BA/Users\19522\AppData\Roaming\Typora\typora-user-images\image-20231106183546942.png" alt="image-20231106183546942"></p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i]=<span class="literal">true</span>;</span><br><span class="line">            pre[++tot]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=tot;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            vis[pre[j]*i]=<span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pre[j]==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="built_in">init</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=pre[i],ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(x&lt;=n)</span><br><span class="line">        &#123;</span><br><span class="line">            ans+=n/x;</span><br><span class="line">            x*=pre[i];</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;pre[i]&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;ans&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ–°çš„é˜¶ä¹˜"><a href="#æ–°çš„é˜¶ä¹˜" class="headerlink" title="æ–°çš„é˜¶ä¹˜"></a><a href="https://www.matiji.net/exam/brushquestion/19/4347/179CE77A7B772D15A8C00DD8198AAC74">æ–°çš„é˜¶ä¹˜</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>å°åº¦æ˜¯ä¸€ä¸ªéå¸¸èªæ˜çš„å°æœ‹å‹ï¼Œä»–å¯¹äºæ•°å­¦æœ‰ç€ç‰¹åˆ«çš„çƒ­çˆ±ã€‚æœ‰ä¸€å¤©ï¼Œä»–åœ¨è¯¾å ‚ä¸Šå­¦ä¹ äº†é˜¶ä¹˜çš„æ¦‚å¿µåï¼Œäº§ç”Ÿäº†ä¸€ä¸ªå¥‡å¦™çš„æƒ³æ³•â€”â€”å¦‚æœæœ‰ä¸€ä¸ªæ•°å­—<em>x</em>ï¼Œé‚£ä¹ˆ<em>x</em>çš„é˜¶ä¹˜å†™ä½œx! &#x3D; xâˆ—(<em>x</em>âˆ’1)âˆ—(<em>x</em>âˆ’2)âˆ—â€¦âˆ—2âˆ—1ã€‚</p>
<p>è¿™ä¸ªç®€å•çš„å®šä¹‰ï¼Œåœ¨å°åº¦çœ‹æ¥æ‹¥æœ‰æ— ç©·çš„é­…åŠ›ã€‚ä»–å¼€å§‹å°è¯•ç”¨é˜¶ä¹˜æ¥å®šä¹‰æ–°çš„è¿ç®—ï¼Œä»–ç›¸ä¿¡è¿™å¯ä»¥å°†å¤æ‚çš„æ•°å­¦é—®é¢˜ç®€åŒ–ã€‚</p>
<p>ä¸€å¤©ï¼Œå°åº¦ååœ¨å…¬å›­é‡Œå­¦ä¹ æ—¶ï¼Œçµæœºä¸€åŠ¨å†™ä¸‹äº†è¿™æ ·ä¸€ä¸ªè¿ç®—å¼f(x)&#x3D;$x^1âˆ—(xâˆ’1)^2âˆ—(xâˆ’2)^3â€¦2^{x-1}âˆ’1^x$ï¼Œç”±äºå°åº¦æ¯”è¾ƒå–œæ¬¢è´¨æ•°ï¼Œä»–å¬è¯´å¤§æ•°çš„è´¨å› å­åˆ†è§£å¾ˆéš¾ï¼Œç°åœ¨å°åº¦æƒ³çŸ¥é“è¿™ä¸ªè¿ç®—å¼å–<em>n</em>æ—¶çš„è´¨å› å­åˆ†è§£å½¢å¼ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>ä¸¾ä¾‹ï¼Œ$16^3$&#x3D;$(2<em>8)^3$&#x3D;$2^3</em>(2<em>4)^3$&#x3D;$2^6</em>(2*2)^3$&#x3D;$2^{12}$</p>
<p>æ¯ä¸ªæ•°çš„å¹‚åˆ†é…ç»™å®ƒçš„æœ€å¤§è´¨å› å­å’Œè¢«è´¨å› å­é™¤åçš„æ•°</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e7</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="type">int</span> vis[N];</span><br><span class="line"><span class="type">int</span> b[N];</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i]=i;</span><br><span class="line">            pre[++tot]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=tot;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            vis[pre[j]*i]=pre[j];</span><br><span class="line">            <span class="keyword">if</span>(i%pre[j]==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="built_in">init</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        b[i]=n+<span class="number">1</span>-i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;<span class="number">1</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(vis[i]==i)<span class="keyword">continue</span>;</span><br><span class="line">        b[i/vis[i]]+=b[i];</span><br><span class="line">        b[vis[i]]+=b[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;f(&quot;</span>&lt;&lt;n&lt;&lt;<span class="string">&quot;)=&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i!=<span class="number">1</span>)cout&lt;&lt;<span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">        cout&lt;&lt;pre[i];</span><br><span class="line">        <span class="keyword">if</span>(b[pre[i]]!=<span class="number">1</span>)cout&lt;&lt;<span class="string">&#x27;^&#x27;</span>&lt;&lt;b[pre[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è´¨æ•°è·ç¦»"><a href="#è´¨æ•°è·ç¦»" class="headerlink" title="è´¨æ•°è·ç¦»"></a><a href="https://www.acwing.com/problem/content/198/">è´¨æ•°è·ç¦»</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸¤ä¸ªæ•´æ•° L å’Œ Uï¼Œä½ éœ€è¦åœ¨é—­åŒºé—´ [L,U] å†…æ‰¾åˆ°è·ç¦»æœ€æ¥è¿‘çš„ä¸¤ä¸ªç›¸é‚»è´¨æ•° C1 å’Œ C2ï¼ˆå³ C2âˆ’C1 æ˜¯æœ€å°çš„ï¼‰ï¼Œå¦‚æœå­˜åœ¨ç›¸åŒè·ç¦»çš„å…¶ä»–ç›¸é‚»è´¨æ•°å¯¹ï¼Œåˆ™è¾“å‡ºç¬¬ä¸€å¯¹ã€‚</p>
<p>åŒæ—¶ï¼Œä½ è¿˜éœ€è¦æ‰¾åˆ°è·ç¦»æœ€è¿œçš„ä¸¤ä¸ªç›¸é‚»è´¨æ•° D1 å’Œ D2ï¼ˆå³ D1âˆ’D2 æ˜¯æœ€å¤§çš„ï¼‰ï¼Œå¦‚æœå­˜åœ¨ç›¸åŒè·ç¦»çš„å…¶ä»–ç›¸é‚»è´¨æ•°å¯¹ï¼Œåˆ™è¾“å‡ºç¬¬ä¸€å¯¹ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>ä»»ä½•ä¸€ä¸ªåˆæ•°Nï¼Œä¸€å®šæœ‰ä¸€ä¸ªè´¨å› å­&lt;&#x3D;$\sqrt n$</p>
<p>è¯æ˜ï¼šN&#x3D;a<em>bï¼Œa&lt;&#x3D;bï¼Œ$a^2$&lt;&#x3D;a</em>b&#x3D;Nï¼Œa&lt;&#x3D;$\sqrt n$</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e4</span>+<span class="number">5</span>,M=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="type">bool</span> vis[M];</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"><span class="type">int</span> b[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i]=<span class="literal">true</span>;</span><br><span class="line">            pre[++tot]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=tot;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            vis[pre[j]*i]=<span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pre[j]==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">init</span>(<span class="number">5e4</span>);</span><br><span class="line">    <span class="type">int</span> l,r;</span><br><span class="line">    <span class="keyword">while</span>(cin&gt;&gt;l&gt;&gt;r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">        <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> p=pre[i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="built_in">max</span>((l+p<span class="number">-1</span>)/p*p<span class="comment">/*ä¸Šå–æ•´*/</span>,<span class="number">2</span>*p);j&lt;=r;j+=p)</span><br><span class="line">            &#123;</span><br><span class="line">                vis[j-l]=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=r-l;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!vis[i])</span><br><span class="line">                b[++cnt]=i+l;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(cnt&lt;<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;There are no adjacent primes.\n&quot;</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mi=<span class="number">2</span>,mx=<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">3</span>;i&lt;=cnt;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> len=b[i]-b[i<span class="number">-1</span>];</span><br><span class="line">            <span class="keyword">if</span>(len&lt;b[mi]-b[mi<span class="number">-1</span>]) mi=i;</span><br><span class="line">            <span class="keyword">if</span>(len&gt;b[mx]-b[mx<span class="number">-1</span>]) mx=i;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;b[mi<span class="number">-1</span>]&lt;&lt;<span class="string">&#x27;,&#x27;</span>&lt;&lt;b[mi]&lt;&lt;<span class="string">&quot; are closest, &quot;</span>;</span><br><span class="line">        cout&lt;&lt;b[mx<span class="number">-1</span>]&lt;&lt;<span class="string">&#x27;,&#x27;</span>&lt;&lt;b[mx]&lt;&lt;<span class="string">&quot; are most distant.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a><a href="https://www.acwing.com/problem/content/875/">æ¬§æ‹‰å‡½æ•°</a></h1><p>1âˆ¼N ä¸­ä¸ N äº’è´¨çš„æ•°çš„ä¸ªæ•°è¢«ç§°ä¸ºæ¬§æ‹‰å‡½æ•°ï¼ˆäº’è´¨å°±æ˜¯æŒ‡ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬å› æ•°æ˜¯1ï¼‰</p>
<p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®š n ä¸ªæ­£æ•´æ•° aiï¼Œè¯·ä½ æ±‚å‡ºæ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<img src="/2024/01/31/%E6%95%B0%E8%AE%BA/Users\19522\AppData\Roaming\Typora\typora-user-images\image-20231106195959688.png" alt="image-20231106195959688" style="zoom:80%;">

<p>å®¹æ–¥åŸç†ï¼šN$<em>$(1-P(A)-P(B)-P(C)+P(AB)+P(AC)+P(BC)-P(ABC))&#x3D;&#x3D;N$</em>$((1-P(A))$<em>$(1-P(B))$</em>$(1-P(C))</p>
<p>æ€»å…±Nä¸ªæ•°-Nçš„å…¶ä¸­ä¸€ä¸ªè´¨å› å­æ‰€åœ¨1-NèŒƒå›´å†…çš„æ‰€æœ‰å€æ•°çš„æ•°é‡-â€¦+å…¶ä¸­è¢«å‡äº†2æ¬¡çš„æ•°çš„ä¸ªæ•°+â€¦-å…¶ä¸­è¢«å¤šåŠ äº†2æ¬¡çš„ä¸ªæ•°â€¦å¾ªç¯</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">while</span>(n--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        cin&gt;&gt;x;</span><br><span class="line">        <span class="type">int</span> res=x;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=x/i;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x%i)<span class="keyword">continue</span>;</span><br><span class="line">            res=res*(i<span class="number">-1</span>)/i;</span><br><span class="line">            <span class="keyword">while</span>(x%i==<span class="number">0</span>)x/=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x&gt;<span class="number">1</span>)res=res*(x<span class="number">-1</span>)/x;</span><br><span class="line">        cout&lt;&lt;res&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°"><a href="#ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°" class="headerlink" title="ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°"></a><a href="https://www.acwing.com/problem/content/876/">ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ªæ­£æ•´æ•° nï¼Œæ±‚ 1âˆ¼n ä¸­æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°ä¹‹å’Œã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>æ¬§æ‹‰å‡½æ•°çš„å…¬å¼æ˜¯nä¹˜ä¸Šæ‰€æœ‰1-å®ƒçš„è´¨å› å­çš„å€’æ•°ï¼Œæ‰€ä»¥å¦‚æœä¸€ä¸ªæ•°aæ˜¯å¦ä¸€ä¸ªæ•°bçš„kå€æ•°ï¼Œå³a&#x3D;kbï¼Œåˆ™Î¦(a)&#x3D;k$*$Î¦(b)ï¼Œå¦‚æœè¿™ä¸ªkä¹Ÿæ˜¯ä¸€ä¸ªè´¨æ•°ï¼š</p>
<ul>
<li>å¦‚æœè¿™ä¸ªkæ˜¯bçš„è´¨å› å­ï¼Œé‚£ä¹ˆ(1-1&#x2F;k)åº”è¯¥åœ¨Î¦(b)å½“ä¸­ï¼Œæ‰€ä»¥ä¸ç”¨å†ä¹˜</li>
<li>å¦‚æœè¿™ä¸ªkä¸æ˜¯bçš„è´¨å› å­ï¼Œè¯´æ˜aæ¯”bå¤šä¸€ä¸ªè´¨å› å­ï¼Œé‚£ä¹ˆÎ¦(a)&#x3D;a$<em>$Î¦(b)&#x2F;b$</em>$(1-1&#x2F;k)ï¼Œå› ä¸ºa&#x2F;b&#x3D;kï¼Œæ‰€ä»¥Î¦(a)&#x3D;Î¦(b)$*$(k-1)</li>
</ul>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> vis[N];</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vis[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            pre[++tot]=i;</span><br><span class="line">            vis[i]=i<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=tot;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pre[j]==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                vis[i*pre[j]]=pre[j]*vis[i];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            vis[i*pre[j]]=(pre[j]<span class="number">-1</span>)*vis[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="built_in">init</span>(n);</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        ans+=vis[i];</span><br><span class="line">    cout&lt;&lt;ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¯è§çš„ç‚¹"><a href="#å¯è§çš„ç‚¹" class="headerlink" title="å¯è§çš„ç‚¹"></a><a href="https://www.acwing.com/problem/content/203/">å¯è§çš„ç‚¹</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>åœ¨ä¸€ä¸ªå¹³é¢ç›´è§’åæ ‡ç³»çš„ç¬¬ä¸€è±¡é™å†…ï¼Œå¦‚æœä¸€ä¸ªç‚¹ (x,y) ä¸åŸç‚¹ (0,0) çš„è¿çº¿ä¸­æ²¡æœ‰é€šè¿‡å…¶ä»–ä»»ä½•ç‚¹ï¼Œåˆ™ç§°è¯¥ç‚¹åœ¨åŸç‚¹å¤„æ˜¯å¯è§çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œç‚¹ (4,2) å°±æ˜¯ä¸å¯è§çš„ï¼Œå› ä¸ºå®ƒä¸åŸç‚¹çš„è¿çº¿ä¼šé€šè¿‡ç‚¹ (2,1)ã€‚</p>
<p>éƒ¨åˆ†å¯è§ç‚¹ä¸åŸç‚¹çš„è¿çº¿å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://www.acwing.com/media/article/image/2019/01/18/19_a68c1a281a-3090_1.png" alt="3090_1.png"></p>
<p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè®¡ç®—ç»™å®šæ•´æ•° N çš„æƒ…å†µä¸‹ï¼Œæ»¡è¶³ 0â‰¤xï¼Œyâ‰¤N çš„å¯è§ç‚¹ (xï¼Œy) çš„æ•°é‡ï¼ˆå¯è§ç‚¹ä¸åŒ…æ‹¬åŸç‚¹ï¼‰ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>è€ƒè™‘åˆ°xä¸yå¦‚æœä¸æ˜¯äº’è´¨çš„è¯ï¼Œxå’Œyéƒ½é™¤ä»¥å®ƒä¸¤çš„æœ€å¤§å…¬çº¦æ•°ï¼Œåˆ™å¾—åˆ°çš„ä¸¤ä¸ªæ•°çš„æ–œç‡å’Œå®ƒä»¬ä¸€æ ·ï¼Œè€Œå¾—åˆ°çš„æ•°å·²ç»å­˜è¿‡äº†ï¼Œæ‰€ä»¥åªæœ‰xä¸yäº’è´¨ï¼Œå­˜çš„ç‚¹æ‰æ˜¯å¯è§çš„</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="type">int</span> vis[N];</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vis[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i]=i<span class="number">-1</span>;</span><br><span class="line">            pre[++tot]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=tot;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pre[j]==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                vis[i*pre[j]]=vis[i]*pre[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            vis[i*pre[j]]=vis[i]*(pre[j]<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">init</span>(N<span class="number">-1</span>);</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin&gt;&gt;t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin&gt;&gt;n;</span><br><span class="line">        <span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">            res+=vis[j]*<span class="number">2</span>;</span><br><span class="line">        cout&lt;&lt;i&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;n&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;res&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æœ€å¤§å…¬çº¦æ•°"><a href="#æœ€å¤§å…¬çº¦æ•°" class="headerlink" title="æœ€å¤§å…¬çº¦æ•°"></a><a href="https://www.acwing.com/problem/content/222/">æœ€å¤§å…¬çº¦æ•°</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šæ•´æ•° Nï¼Œæ±‚ 1â‰¤x,yâ‰¤N ä¸” GCD(x,y) ä¸ºç´ æ•°çš„æ•°å¯¹ (x,y) æœ‰å¤šå°‘å¯¹ã€‚</p>
<p>GCD(x,y) å³æ±‚ xï¼Œy çš„æœ€å¤§å…¬çº¦æ•°ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>æ±‚gcd(x,y)&#x3D;&#x3D;âˆ‘p â€“&gt; âˆ‘gcd(x&#x2F;p,y&#x2F;p)&#x3D;&#x3D;1</p>
<p>æ‰€ä»¥åªè¦æ±‚å‡º1-N&#x2F;âˆ‘pä¸­äº’è´¨çš„æ•°é‡</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e7</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="type">int</span> vis[N];</span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i]=i<span class="number">-1</span>;</span><br><span class="line">            pre[++tot]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=tot;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pre[j]==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                vis[i*pre[j]]=vis[i]*pre[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            vis[i*pre[j]]=vis[i]*(pre[j]<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        vis[i]+=vis[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="built_in">init</span>(n);</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;i++)</span><br><span class="line">        ans+=vis[n/pre[i]]*<span class="number">2</span>+<span class="number">1</span>;</span><br><span class="line">    cout&lt;&lt;ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="çº¦æ•°"><a href="#çº¦æ•°" class="headerlink" title="çº¦æ•°"></a>çº¦æ•°</h1><h2 id="çº¦æ•°ä¸ªæ•°"><a href="#çº¦æ•°ä¸ªæ•°" class="headerlink" title="çº¦æ•°ä¸ªæ•°"></a><a href="https://www.acwing.com/problem/content/872/">çº¦æ•°ä¸ªæ•°</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®š n ä¸ªæ­£æ•´æ•° aiï¼Œè¯·ä½ è¾“å‡ºè¿™äº›æ•°çš„ä¹˜ç§¯çš„çº¦æ•°ä¸ªæ•°ï¼Œç­”æ¡ˆå¯¹ 1e9+7 å–æ¨¡ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<img src="/2024/01/31/%E6%95%B0%E8%AE%BA/Users\19522\AppData\Roaming\Typora\typora-user-images\image-20231101172706526.png" alt="image-20231101172706526" style="zoom: 80%;">

<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;pre;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">while</span>(n--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=x/i;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span>(x%i==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                pre[i]++;</span><br><span class="line">                x/=i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x&gt;<span class="number">1</span>)pre[x]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it:pre)ans=ans*(it.second+<span class="number">1</span>)%mod;</span><br><span class="line">    cout&lt;&lt;ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="å…¬å€æ•°"><a href="#å…¬å€æ•°" class="headerlink" title="å…¬å€æ•°"></a>å…¬å€æ•°</h1><h2 id="æœ€å°å…¬å€æ•°"><a href="#æœ€å°å…¬å€æ•°" class="headerlink" title=" æœ€å°å…¬å€æ•°"></a><a href="http://oj.ecustacm.cn/problem.php?id=1820"> æœ€å°å…¬å€æ•°</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ªæ•°å­—nï¼Œè¯·é—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªåŒºé—´<a href="l%E2%89%A0r">l,r</a>ï¼Œä½¿å¾—nç­‰äºæ•´ä¸ªåŒºé—´æ‰€æœ‰æ•°å­—çš„æœ€å°å…¬å€æ•°ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>åˆå§‹åŒ–å°†æ‰€æœ‰åŒºé—´çš„æœ€å°å…¬å€æ•°éƒ½æ±‚å‡ºæ¥å­˜åœ¨mapä¸­ï¼Œå› ä¸ºåŒºé—´åªæœ‰ä¸¤ä¸ªçš„è¯å¯ä»¥ç›´æ¥æ‹¿æ‰€ç»™æ•°å­—æ¥é€†ç€åˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥åŒºé—´å¯ä»¥æœ€çŸ­ä¸º3ï¼Œå› æ­¤å¾ªç¯å¯ä»¥é™åˆ°1e6ï¼Œå› ä¸ºä¸‰ä¸ªè¿ç»­æ•°å­—çš„æœ€å°å…¬å€æ•°å®ƒå¯èƒ½ä¼šæ˜¯ä¸‰ä¸ªæ•°ä¹˜ç§¯&#x2F;2ï¼ˆå½“ç¬¬ä¸€ä¸ªæ•°å­—ä¸ºå¶æ•°çš„æ—¶å€™ï¼‰ï¼Œæ‰€ä»¥å¾ªç¯éå†è¦åˆ°2e6ï¼Œæ›´é•¿çš„è¿ç»­æ•°å­—å®ƒèƒ½éå†åˆ°çš„ç»ˆç‚¹ä¸€å®šæ˜¯æ¯”ä¸‰ä¸ªå°çš„ï¼Œæ‰€ä»¥å¾ªç¯æœ€å¤§é•¿åº¦å°±ä¸º2e6</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> inf=<span class="number">1e18</span>;</span><br><span class="line">map&lt;<span class="type">int</span>,pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;mp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lcm</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a/__gcd(a,b)*b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>;l&lt;=<span class="number">2000000</span>;l++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> sum=l*(l+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> r=l+<span class="number">2</span>;;r++)</span><br><span class="line">        &#123;</span><br><span class="line">            sum=<span class="built_in">lcm</span>(sum,r);</span><br><span class="line">            <span class="keyword">if</span>(sum&gt;inf||sum&lt;=<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(mp.<span class="built_in">count</span>(sum))<span class="keyword">continue</span>;</span><br><span class="line">            mp[sum]=&#123;l,r&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin&gt;&gt;t;</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin&gt;&gt;n;</span><br><span class="line">        <span class="type">int</span> x=<span class="built_in">sqrt</span>(n);</span><br><span class="line">        <span class="keyword">if</span>(x*(x+<span class="number">1</span>)==n)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(mp.<span class="built_in">count</span>(n))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(mp[n].first&lt;x)cout&lt;&lt;mp[n].first&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;mp[n].second&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">                <span class="keyword">else</span> cout&lt;&lt;x&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;x+<span class="number">1</span>&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> cout&lt;&lt;x&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;x+<span class="number">1</span>&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(mp.<span class="built_in">count</span>(n))</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;mp[n].first&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;mp[n].second&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;-1\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="å¿«é€Ÿå¹‚"><a href="#å¿«é€Ÿå¹‚" class="headerlink" title="å¿«é€Ÿå¹‚"></a>å¿«é€Ÿå¹‚</h1><h2 id="è¶Šç‹±"><a href="#è¶Šç‹±" class="headerlink" title="è¶Šç‹±"></a><a href="https://www.acwing.com/problem/content/1292/">è¶Šç‹±</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç›‘ç‹±æœ‰è¿ç»­ç¼–å·ä¸º 1 åˆ° n çš„ n ä¸ªæˆ¿é—´ï¼Œæ¯ä¸ªæˆ¿é—´å…³æŠ¼ä¸€ä¸ªçŠ¯äººã€‚</p>
<p>æœ‰ m ç§å®—æ•™ï¼Œæ¯ä¸ªçŠ¯äººå¯èƒ½ä¿¡ä»°å…¶ä¸­ä¸€ç§ã€‚</p>
<p>ä¸å­˜åœ¨æ²¡æœ‰ä¿¡ä»°çš„çŠ¯äººã€‚</p>
<p>å¦‚æœç›¸é‚»æˆ¿é—´çš„çŠ¯äººä¿¡ä»°çš„å®—æ•™ç›¸åŒï¼Œå°±å¯èƒ½å‘ç”Ÿè¶Šç‹±ã€‚</p>
<p>æ±‚æœ‰å¤šå°‘ç§çŠ¶æ€å¯èƒ½å‘ç”Ÿè¶Šç‹±ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>æ€»çš„å¯èƒ½æ’åºæœ‰$m^n$ç§ï¼Œä¸ä¼šè¶Šç‹±çš„å¯èƒ½ä¸ºm*$(m-1)^{n-1}$ï¼Œç”¨å¿«é€Ÿå¹‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">100003</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> r=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(y&amp;<span class="number">1</span>)r=r*x%mod;</span><br><span class="line">        x=x*x%mod;</span><br><span class="line">        y&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> m,n;</span><br><span class="line">    cin&gt;&gt;m&gt;&gt;n;</span><br><span class="line">    cout&lt;&lt;(<span class="built_in">qmi</span>(m,n)-m*<span class="built_in">qmi</span>(m<span class="number">-1</span>,n<span class="number">-1</span>)%mod+mod)%mod&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¿«é€Ÿå¹‚æ±‚é€†å…ƒ"><a href="#å¿«é€Ÿå¹‚æ±‚é€†å…ƒ" class="headerlink" title="å¿«é€Ÿå¹‚æ±‚é€†å…ƒ"></a><a href="https://www.acwing.com/problem/content/878/">å¿«é€Ÿå¹‚æ±‚é€†å…ƒ</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®š n ç»„ ai,piï¼Œå…¶ä¸­ pi æ˜¯è´¨æ•°ï¼Œæ±‚ ai æ¨¡ pi çš„ä¹˜æ³•é€†å…ƒï¼Œè‹¥é€†å…ƒä¸å­˜åœ¨åˆ™è¾“å‡º <code>impossible</code>ã€‚</p>
<p>æ³¨æ„ï¼šè¯·è¿”å›åœ¨ 0âˆ¼pâˆ’1 ä¹‹é—´çš„é€†å…ƒã€‚</p>
<p>ä¹˜æ³•é€†å…ƒçš„å®šä¹‰</p>
<blockquote>
<p>è‹¥æ•´æ•° bï¼Œm äº’è´¨ï¼Œå¹¶ä¸”å¯¹äºä»»æ„çš„æ•´æ•° aï¼Œå¦‚æœæ»¡è¶³ b|aï¼Œåˆ™å­˜åœ¨ä¸€ä¸ªæ•´æ•° xï¼Œä½¿å¾— a&#x2F;bâ‰¡a*x(mod m)ï¼Œåˆ™ç§° x ä¸º b çš„æ¨¡ m ä¹˜æ³•é€†å…ƒï¼Œè®°ä¸º bâˆ’1(mod m)ã€‚</p>
<p>b å­˜åœ¨ä¹˜æ³•é€†å…ƒçš„å……è¦æ¡ä»¶æ˜¯ b ä¸æ¨¡æ•° m äº’è´¨ã€‚å½“æ¨¡æ•° m ä¸ºè´¨æ•°æ—¶ï¼Œ$b^{mâˆ’2}$ å³ä¸º b çš„ä¹˜æ³•é€†å…ƒã€‚</p>
</blockquote>
<p><strong>æ€è·¯</strong></p>
<p>æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶</p>
<ul>
<li>mæ˜¯è´¨æ•°</li>
<li>bä¸mäº’è´¨</li>
</ul>
<p>åˆ™$b^{-1}$â‰¡$b^{m-2}$(mod m)</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> p,<span class="type">int</span> mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> r=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(p&amp;<span class="number">1</span>)r=r*a%mod;</span><br><span class="line">        a=a*a%mod;</span><br><span class="line">        p&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin&gt;&gt;t;</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a,p;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;p;</span><br><span class="line">        <span class="keyword">if</span>(__gcd(a,p)==<span class="number">1</span>)</span><br><span class="line">            cout&lt;&lt;<span class="built_in">qmi</span>(a,p<span class="number">-2</span>,p)&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;impossible\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="çŸ©é˜µä¹˜æ³•"><a href="#çŸ©é˜µä¹˜æ³•" class="headerlink" title="çŸ©é˜µä¹˜æ³•"></a>çŸ©é˜µä¹˜æ³•</h1><h2 id="æ–æ³¢é‚£å¥‘å‰-n-é¡¹å’Œ"><a href="#æ–æ³¢é‚£å¥‘å‰-n-é¡¹å’Œ" class="headerlink" title="æ–æ³¢é‚£å¥‘å‰ n é¡¹å’Œ"></a><a href="https://www.acwing.com/problem/content/1305/">æ–æ³¢é‚£å¥‘å‰ n é¡¹å’Œ</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>å¤§å®¶éƒ½çŸ¥é“ Fibonacci æ•°åˆ—å§ï¼Œf1&#x3D;1,f2&#x3D;1,f3&#x3D;2,f4&#x3D;3,â€¦,fn&#x3D;fnâˆ’1+fnâˆ’2ã€‚</p>
<p>ç°åœ¨é—®é¢˜å¾ˆç®€å•ï¼Œè¾“å…¥ n å’Œ mï¼Œæ±‚ fn çš„å‰ n é¡¹å’Œ Sn mod mã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>çŸ©é˜µ$<em>$çŸ©é˜µï¼Œé‡è½½è¿ç®—ç¬¦$</em>$ï¼Œå› ä¸ºå¹‚å¤§ç”¨å¿«é€Ÿå¹‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">int</span> n,mod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> mp[<span class="number">3</span>][<span class="number">3</span>]=&#123;</span><br><span class="line">        <span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">        <span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">        <span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">    &#125;;</span><br><span class="line">    node <span class="keyword">operator</span>*(<span class="type">const</span> node&amp;b)<span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        node ans;</span><br><span class="line">        <span class="built_in">memset</span>(ans.mp,<span class="number">0</span>,<span class="keyword">sizeof</span> ans.mp);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;<span class="number">3</span>;k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    ans.mp[i][j]+=mp[i][k]*b.mp[k][j];</span><br><span class="line">                    ans.mp[i][j]%=mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">node <span class="title">qmul</span><span class="params">(node a,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    node ans;</span><br><span class="line">    <span class="built_in">memset</span>(ans.mp,<span class="number">0</span>,<span class="keyword">sizeof</span> ans.mp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)ans.mp[i][i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>)ans=ans*a;</span><br><span class="line">        a=a*a;</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;mod;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;<span class="number">3</span>)&#123;</span><br><span class="line">        cout&lt;&lt;<span class="number">1</span>%mod&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    node a;</span><br><span class="line">    node ans=<span class="built_in">qmul</span>(a,n<span class="number">-2</span>);</span><br><span class="line">    cout&lt;&lt;(ans.mp[<span class="number">0</span>][<span class="number">0</span>]*<span class="number">2</span>+ans.mp[<span class="number">0</span>][<span class="number">1</span>]+ans.mp[<span class="number">0</span>][<span class="number">2</span>])%mod&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•"></a><a href="https://www.acwing.com/problem/content/879/">æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</a></h1><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®š n å¯¹æ­£æ•´æ•° $a_i$,$b_i$ï¼Œå¯¹äºæ¯å¯¹æ•°ï¼Œæ±‚å‡ºä¸€ç»„ $x_i$,$y_i$ï¼Œä½¿å…¶æ»¡è¶³ $a_i$Ã—$x_i$+$b_i$Ã—$y_i$&#x3D;gcd($a_i$,$b_i$)ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p><img src="/2024/01/31/%E6%95%B0%E8%AE%BA/Users\19522\AppData\Roaming\Typora\typora-user-images\image-20231108183845794.png" alt="image-20231108183845794"></p>
<p>å› ä¸º</p>
<ul>
<li>gcd(a,b)&#x3D;gcd(b,a%b)</li>
</ul>
<p>è€Œ</p>
<ul>
<li>bxâ€²+(a%b)yâ€²&#x3D;gcd(b,a%b)</li>
<li>bxâ€²+(aâˆ’âŒŠa&#x2F;bâŒ‹âˆ—b)yâ€²&#x3D;gcd(b,a%b)</li>
<li>ayâ€²+b(xâ€²âˆ’âŒŠa&#x2F;bâŒ‹âˆ—yâ€²)&#x3D;gcd(b,a%b)&#x3D;gcd(a,b)</li>
</ul>
<p>æ•…è€Œ</p>
<ul>
<li>x&#x3D;yâ€²,y&#x3D;xâ€²âˆ’âŒŠa&#x2F;bâŒ‹âˆ—yâ€²</li>
</ul>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">        x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> dx,dy;</span><br><span class="line">    <span class="built_in">exgcd</span>(b,a%b,dx,dy);</span><br><span class="line">    x=dy,y=dx-a/b*dy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin&gt;&gt;t;</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a,b,x,y;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">        <span class="built_in">exgcd</span>(a,b,x,y);</span><br><span class="line">        cout&lt;&lt;x&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;y&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="æ•°è®º"><a href="#æ•°è®º" class="headerlink" title="æ•°è®º"></a>æ•°è®º</h1><h2 id="ç¿»å€"><a href="#ç¿»å€" class="headerlink" title="ç¿»å€"></a><a href="https://www.acwing.com/problem/content/5289/">ç¿»å€</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸¤ä¸ªæ­£æ•´æ•°ï¼Œåˆå§‹æ—¶ä¸¤æ•°å‡ä¸º 11ã€‚</p>
<p>ä½ å¯ä»¥è¿›è¡Œä»»æ„æ¬¡ï¼ˆä¹Ÿå¯ä»¥ä¸è¿›è¡Œï¼‰ç¿»å€æ“ä½œï¼Œæ¯æ¬¡æ“ä½œä»»é€‰ä¸€ä¸ªéè´Ÿæ•´æ•° kï¼Œä»¤ä¸¤æ•°ä¸­çš„ä¸€ä¸ªæ•°ä¹˜ä»¥ kï¼Œå¦ä¸€ä¸ªæ•°ä¹˜ä»¥ $k^2$ã€‚</p>
<p>è¯·ä½ è®¡ç®—ï¼Œæ˜¯å¦èƒ½å¤Ÿé€šè¿‡ä¸€ç³»åˆ—æ“ä½œï¼Œä½¿å¾—æœ€ç»ˆç¬¬ä¸€ä¸ªæ•°å˜ä¸º aï¼Œç¬¬äºŒä¸ªæ•°å˜ä¸º bã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p><img src="/2024/01/31/%E6%95%B0%E8%AE%BA/Users\19522\AppData\Roaming\Typora\typora-user-images\image-20231108211056470.png" alt="image-20231108211056470"></p>
<p>å…¶ä¸­a1ã€a2ã€â€¦ã€akæ¯ä¸ªéƒ½åº”è¯¥æ˜¯3çš„å€æ•°</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin&gt;&gt;t;</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a,b;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">        <span class="type">int</span> c=<span class="built_in">cbrt</span>(a*b);</span><br><span class="line">        <span class="keyword">if</span>(c*c*c==a*b &amp;&amp; a%c==<span class="number">0</span> &amp;&amp; b%c==<span class="number">0</span>)cout&lt;&lt;<span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;No\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>æ•°æ®ç»“æ„</title>
    <url>/2024/01/31/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
    <content><![CDATA[<h1 id="KMPå­—ç¬¦ä¸²"><a href="#KMPå­—ç¬¦ä¸²" class="headerlink" title="KMPå­—ç¬¦ä¸²"></a><a href="https://www.acwing.com/problem/content/833/">KMPå­—ç¬¦ä¸²</a></h1><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œä»¥åŠä¸€ä¸ªæ¨¡å¼ä¸² Pï¼Œæ‰€æœ‰å­—ç¬¦ä¸²ä¸­åªåŒ…å«å¤§å°å†™è‹±æ–‡å­—æ¯ä»¥åŠé˜¿æ‹‰ä¼¯æ•°å­—ã€‚</p>
<p>æ¨¡å¼ä¸² P åœ¨å­—ç¬¦ä¸² S ä¸­å¤šæ¬¡ä½œä¸ºå­ä¸²å‡ºç°ã€‚</p>
<p>æ±‚å‡ºæ¨¡å¼ä¸² P åœ¨å­—ç¬¦ä¸² S ä¸­æ‰€æœ‰å‡ºç°çš„ä½ç½®çš„èµ·å§‹ä¸‹æ ‡ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/74049c5e1e6049b8b8e53d6044bb9ee3.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><strong>æ€è·¯</strong></p>
<p>å…ˆéå†å­—ç¬¦ä¸² Pï¼Œæ‰¾å‡º P ä¸­ç›¸åŒå¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œä¸‹æ ‡ i ä»å­—ç¬¦ä¸² P ä¸­çš„ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹éå†ï¼Œä¸‹æ ‡ j ä¸€å¼€å§‹æŒ‡å‘ 0ï¼Œä¸è¡¨ç¤ºä»»ä½•å­—ç¬¦ï¼Œå¦‚æœ i æ»¡è¶³ j+1ï¼Œåˆ™å­—ç¬¦ä¸² P ä¸­ç¬¬ i çš„å­—ç¬¦å¯¹åº”äºç¬¬ j+1 çš„å­—ç¬¦ï¼›å¦‚æœä¸æ»¡è¶³ï¼Œåˆ™å‰é¢æ²¡æœ‰å¯¹åº”äº i çš„å­—ç¬¦ã€‚è¿ç»­ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œj ++ï¼Œæ‰€ä»¥åé¢æœ‰ä¸€å­—ä¸²æ»¡è¶³å­—ç¬¦ä¸²å‰é¢è¿ç»­çš„ä¸€æ®µå­—ä¸²ï¼Œåˆ™æœ€åä¸€ä¸ªå­—ç¬¦ä¸²ä¸‹æ ‡ i æ‰€å¯¹åº”çš„ j å°±æ˜¯å­—ä¸²çš„é•¿åº¦ã€‚</p>
<p>æ•°ç»„neè¡¨ç¤ºå­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦æ‰€èƒ½å¯¹åº”çš„å‰ç¼€æœ€é•¿çš„é•¿åº¦ã€‚</p>
<p>æ¯ä¸ªå¾ªç¯ä¸­ j è¡¨ç¤º i å‰é¢æœ‰ j ä¸ªå­—ç¬¦ç›¸åŒã€‚</p>
<ul>
<li><p>è‹¥ä¸åŒ¹é…ï¼Œè®©jå›è·³ï¼Œç›´åˆ°åŒ¹é…æˆ–j&#x3D;0ã€‚</p>
</li>
<li><p>è‹¥åŒ¹é…ï¼Œè®©j+1ï¼Œne[i]&#x3D;jï¼›</p>
</li>
</ul>
<p>![img](file:&#x2F;&#x2F;&#x2F;C:\Users\19522\Documents\Tencent Files\1952287329\Image\C2C\C76178F520D2C0965E66B74483A8F62A.jpg)</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,M=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> ne[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m;</span><br><span class="line">    <span class="type">char</span> p[N],s[M];</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;p+<span class="number">1</span>&gt;&gt;m&gt;&gt;s+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>,i=<span class="number">2</span>;i&lt;=n;i++)		<span class="comment">//å¦‚æœä»ç¬¬ä¸€ä¸ªéå†,åˆ™ne[1]=1,æ­»å¾ªç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(j&amp;&amp;p[j+<span class="number">1</span>]!=p[i])j=ne[j];</span><br><span class="line">        <span class="keyword">if</span>(p[j+<span class="number">1</span>]==p[i])j++;</span><br><span class="line">        ne[i]=j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(j&amp;&amp;p[j+<span class="number">1</span>]!=s[i])j=ne[j];</span><br><span class="line">        <span class="keyword">if</span>(p[j+<span class="number">1</span>]==s[i])j++;</span><br><span class="line">        <span class="keyword">if</span>(j==n)</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;i-j&lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¥‘åˆåŒ¹é…"><a href="#å¥‘åˆåŒ¹é…" class="headerlink" title="å¥‘åˆåŒ¹é…"></a><a href="https://www.lanqiao.cn/problems/5132/learning/?contest_id=144">å¥‘åˆåŒ¹é…</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>å°è“æœ‰å¾ˆå¤šé½¿è½®ï¼Œæ¯ä¸ªé½¿è½®çš„å‡¸èµ·å’Œå‡¹é™·åˆ†åˆ«ç”¨ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºï¼Œä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºä¸€ä¸ªé½¿è½®ã€‚ å¦‚æœä¸¤ä¸ªé½¿è½®çš„å¯¹åº”ä½åˆ†åˆ«æ˜¯åŒä¸€ä¸ªå­—æ¯çš„å¤§å°å†™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸¤ä¸ªé½¿è½®æ˜¯å¥‘åˆçš„ã€‚ ä¾‹å¦‚ï¼šAbCDeFgh å’Œ aBcdEfGH å°±æ˜¯å¥‘åˆçš„ï¼Œä½†æ˜¯ abc å’Œ aBC ä¸æ˜¯å¥‘åˆçš„ã€‚ è¿™å¤©ï¼Œå°è“çš„å¼Ÿå¼Ÿå°æ¡¥ä»æŠ½å±‰é‡Œæ‹¿æ¥äº†ä¸¤ä¸ªé½¿è½®ï¼Œå°è“æƒ³çŸ¥é“ï¼Œè¿™ä¿©ä¸ªé½¿è½®æ˜¯ä¸æ˜¯å¥‘åˆçš„ã€‚ ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé½¿è½®æ˜¯ç¯å½¢çš„ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥æ—‹è½¬çš„ï¼ˆé¡ºæ—¶é’ˆå’Œé€†æ—¶é’ˆå‡å¯ï¼‰ï¼Œå¦‚æœæ˜¯å¥‘ åˆçš„ï¼Œå°è“è¿˜æƒ³è®©ä½ å‘Šè¯‰ä»–ï¼Œæœ€å°‘å°†ç¬¬ä¸€ä¸ªé½¿è½®æ—‹è½¬å¤šå°‘ä½ï¼Œä¸¤ä¸ªé½¿è½®å¯ä»¥å®Œå…¨å¥‘åˆåœ¨ä¸€ èµ·ã€‚ ä¾‹å¦‚ï¼š AbbCd ä¸ BcDaBï¼Œåœ¨å°†ç¬¬ä¸€ä¸ªé½¿è½®é€†æ—¶é’ˆæ—‹è½¬ä¸¤ä½åï¼Œå˜æˆ bCdAb ï¼Œä¸¤ä¸ªé½¿è½®å°±å®Œå…¨ å¥‘åˆåœ¨ä¸€èµ·äº†ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>å…ˆå°†ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å…¨éƒ¨è½¬æ¢ï¼Œå­˜è¿›å¦ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå­˜ä¸¤å€å¤§å°ï¼Œåˆ¤æ–­ç¬¬äºŒä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨è¿™ä¸ªå­—ç¬¦ä¸²é‡Œé¢ï¼Œç”¨åˆ°äº†KMPã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">string a;</span><br><span class="line"><span class="type">char</span> p[N],s[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> ne[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;a&gt;&gt;p+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i]&gt;=<span class="string">&#x27;A&#x27;</span>&amp;&amp;a[i]&lt;=<span class="string">&#x27;Z&#x27;</span>)a[i]=<span class="built_in">tolower</span>(a[i]);</span><br><span class="line">		<span class="keyword">else</span> a[i]=<span class="built_in">toupper</span>(a[i]);</span><br><span class="line">		s[i+<span class="number">1</span>]=s[n+i+<span class="number">1</span>]=a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>,i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="keyword">while</span>(j&amp;&amp;p[j+<span class="number">1</span>]!=p[i])j=ne[j];</span><br><span class="line">		<span class="keyword">if</span>(p[j+<span class="number">1</span>]==p[i])j++;</span><br><span class="line">		ne[i]=j;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;=<span class="number">2</span>*n;i++)&#123;</span><br><span class="line">		<span class="keyword">while</span>(j&amp;&amp;s[i]!=p[j+<span class="number">1</span>])j=ne[j];</span><br><span class="line">		<span class="keyword">if</span>(s[i]==p[j+<span class="number">1</span>])j++;</span><br><span class="line">		<span class="keyword">if</span>(j==n)&#123;</span><br><span class="line">			cout&lt;&lt;<span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">			cout&lt;&lt;<span class="built_in">min</span>(i-j,n-(i-j));</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;<span class="string">&quot;No&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h1><h2 id="é£Ÿç‰©é“¾"><a href="#é£Ÿç‰©é“¾" class="headerlink" title="é£Ÿç‰©é“¾"></a><a href="https://www.acwing.com/problem/content/242/">é£Ÿç‰©é“¾</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>åŠ¨ç‰©ç‹å›½ä¸­æœ‰ä¸‰ç±»åŠ¨ç‰© A,B,Cï¼Œè¿™ä¸‰ç±»åŠ¨ç‰©çš„é£Ÿç‰©é“¾æ„æˆäº†æœ‰è¶£çš„ç¯å½¢ã€‚A åƒ Bï¼ŒB åƒ Cï¼ŒC åƒ Aã€‚</p>
<p>ç°æœ‰ N ä¸ªåŠ¨ç‰©ï¼Œä»¥ 1 ~ N ç¼–å·ã€‚æ¯ä¸ªåŠ¨ç‰©éƒ½æ˜¯ A,B,C ä¸­çš„ä¸€ç§ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒåˆ°åº•æ˜¯å“ªä¸€ç§ã€‚</p>
<p>æœ‰äººç”¨ä¸¤ç§è¯´æ³•å¯¹è¿™ N ä¸ªåŠ¨ç‰©æ‰€æ„æˆçš„é£Ÿç‰©é“¾å…³ç³»è¿›è¡Œæè¿°ï¼š</p>
<p>- ç¬¬ä¸€ç§è¯´æ³•æ˜¯ 1 X Yï¼Œè¡¨ç¤º X å’Œ Y æ˜¯åŒç±»ã€‚<br> - ç¬¬äºŒç§è¯´æ³•æ˜¯ 2 X Yï¼Œè¡¨ç¤º X åƒ Yã€‚</p>
<p>æ­¤äººå¯¹ N ä¸ªåŠ¨ç‰©ï¼Œç”¨ä¸Šè¿°ä¸¤ç§è¯´æ³•ï¼Œä¸€å¥æ¥ä¸€å¥åœ°è¯´å‡º K å¥è¯ï¼Œè¿™ K å¥è¯æœ‰çš„æ˜¯çœŸçš„ï¼Œæœ‰çš„æ˜¯å‡çš„ã€‚å½“ä¸€å¥è¯æ»¡è¶³ä¸‹åˆ—ä¸‰æ¡ä¹‹ä¸€æ—¶ï¼Œè¿™å¥è¯å°±æ˜¯å‡è¯ï¼Œå¦åˆ™å°±æ˜¯çœŸè¯ã€‚</p>
<p>- å½“å‰çš„è¯ä¸å‰é¢çš„æŸäº›çœŸçš„è¯å†²çªï¼Œå°±æ˜¯å‡è¯ï¼›<br> - å½“å‰çš„è¯ä¸­ X æˆ– Y æ¯” N å¤§ï¼Œå°±æ˜¯å‡è¯ï¼›<br> - å½“å‰çš„è¯è¡¨ç¤º X åƒ Xï¼Œå°±æ˜¯å‡è¯ã€‚</p>
<p>ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ç»™å®šçš„ N å’Œ K å¥è¯ï¼Œè¾“å‡ºå‡è¯çš„æ€»æ•°ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>æ•°ç»„raå­˜å‚¨å­èŠ‚ç‚¹ä¸æ ¹èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ï¼š0è¡¨ç¤ºåŒç±»ï¼Œ1è¡¨ç¤ºç‹©çŒï¼Œ2è¡¨ç¤ºè¢«çŒ</p>
<p>å› ä¸ºdåªèƒ½æ˜¯1æˆ–2åˆ†è¡¨è¡¨ç¤ºåŒç±»å’Œç‹©çŒæ‰€ä»¥è¦d-1</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mxn=<span class="number">5e4</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> fa[mxn],ra[mxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x==fa[x])<span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="type">int</span> t=fa[x];</span><br><span class="line">        fa[x]=<span class="built_in">find</span>(fa[x]);</span><br><span class="line">        ra[x]=(ra[x]+ra[t])%<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fa[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,k,d,x,y,ans;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)fa[i]=i;</span><br><span class="line">    <span class="keyword">while</span>(k--)&#123;</span><br><span class="line">        cin&gt;&gt;d&gt;&gt;x&gt;&gt;y;</span><br><span class="line">        <span class="keyword">if</span>(x&gt;n||y&gt;n||d==<span class="number">2</span>&amp;&amp;x==y)ans++;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> u=<span class="built_in">find</span>(x),v=<span class="built_in">find</span>(y);</span><br><span class="line">            <span class="keyword">if</span>(u==v)&#123;</span><br><span class="line">                <span class="keyword">if</span>((ra[x]-ra[y]+<span class="number">3</span>)%<span class="number">3</span>!=d<span class="number">-1</span>)ans++;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                fa[u]=v;</span><br><span class="line">                ra[u]=(ra[y]+d<span class="number">-1</span>-ra[x])%<span class="number">3</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è™«å­çš„ç”Ÿæ´»"><a href="#è™«å­çš„ç”Ÿæ´»" class="headerlink" title="è™«å­çš„ç”Ÿæ´»"></a><a href="http://poj.org/problem?id=2492">è™«å­çš„ç”Ÿæ´»</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>éœç€æ•™æˆæ­£åœ¨ç ”ç©¶ä¸€ç§ç¨€æœ‰è™«å­çš„æ€§è¡Œä¸ºã€‚ä»–å‡è®¾å®ƒä»¬å…·æœ‰ä¸¤ç§ä¸åŒçš„æ€§åˆ«ï¼Œå¹¶ä¸”å®ƒä»¬åªä¸å¼‚æ€§çš„è™«å­äº’åŠ¨ã€‚åœ¨ä»–çš„å®éªŒä¸­ï¼Œå•ä¸ªè™«å­åŠå…¶ç›¸äº’ä½œç”¨å¾ˆå®¹æ˜“è¯†åˆ«ï¼Œå› ä¸ºå®ƒä»¬çš„èƒŒä¸Šå°æœ‰æ•°å­—ã€‚</p>
<p>ç»™å®šä¸€ä¸ªé”™è¯¯äº¤äº’åˆ—è¡¨ï¼Œç¡®å®šå®éªŒæ˜¯å¦æ”¯æŒä»–å‡è®¾çš„ä¸¤ç§æ€§åˆ«æ²¡æœ‰åŒæ€§æ‹é”™è¯¯ï¼Œæˆ–è€…å®ƒæ˜¯å¦åŒ…å«ä¸€äº›ä¼ªé€ å®ƒçš„é”™è¯¯äº¤äº’ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mxn=<span class="number">2005</span>;</span><br><span class="line"><span class="type">int</span> fa[mxn],ra[mxn],tot;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x==fa[x])<span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="type">int</span> t=fa[x];</span><br><span class="line">        fa[x]=<span class="built_in">find</span>(fa[x]);</span><br><span class="line">        ra[x]=(ra[x]+ra[t])%<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fa[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t,n,m;</span><br><span class="line">    cin&gt;&gt;t;</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;Scenario #&quot;</span>&lt;&lt;++tot&lt;&lt;<span class="string">&quot;:\n&quot;</span>;</span><br><span class="line">        cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">        <span class="type">int</span> flag=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)fa[i]=i,ra[i]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">            <span class="type">int</span> u,v;</span><br><span class="line">            cin&gt;&gt;u&gt;&gt;v;</span><br><span class="line">            <span class="type">int</span> x=<span class="built_in">find</span>(u),y=<span class="built_in">find</span>(v);</span><br><span class="line">            <span class="keyword">if</span>(x!=y)&#123;</span><br><span class="line">                fa[x]=y;</span><br><span class="line">                ra[x]=(<span class="number">1</span>+ra[v]-ra[u])%<span class="number">2</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(ra[u]==ra[v])&#123;</span><br><span class="line">                    flag=<span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(flag)cout&lt;&lt;<span class="string">&quot;No suspicious bugs found!\n\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;Suspicious bugs found!\n\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="hdu3635"><a href="#hdu3635" class="headerlink" title="hdu3635"></a><a href="https://acm.hdu.edu.cn/showproblem.php?pid=3635">hdu3635</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>Five hundred years later, the number of dragon balls will increase unexpectedly, so itâ€™s too difficult for Monkey King(WuKong) to gather all of the dragon balls together.<br><img src="https://acm.hdu.edu.cn/data/images/C308_1004_1.jpg" alt="img"><br>His country has N cities and there are exactly N dragon balls in the world. At first, for the ith dragon ball, the sacred dragon will puts it in the ith city. Through long years, some citiesâ€™ dragon ball(s) would be transported to other cities. To save physical strength WuKong plans to take Flying Nimbus Cloud, a magical flying cloud to gather dragon balls.<br>Every time WuKong will collect the information of one dragon ball, he will ask you the information of that ball. You must tell him which city the ball is located and how many dragon balls are there in that city, you also need to tell him how many times the ball has been transported so far.</p>
<p><strong>æ€è·¯</strong></p>
<p>å®ƒè¦è¾“å‡ºæœ€åè¿™ä¸ªé¾™ç åˆ°è¾¾çš„åŸå¸‚ç¼–å·ã€è¿™ä¸ªåŸå¸‚é¾™ç çš„æ•°é‡ã€è¿™ä¸ªé¾™ç èµ°äº†å‡ æ¬¡</p>
<p>é¾™ç æœ€ååˆ°è¾¾çš„åŸå¸‚ç”¨çˆ¶èŠ‚ç‚¹æ‰¾å¾ˆå®¹æ˜“æ±‚å‡ºæ¥ï¼ŒåŸå¸‚é¾™ç çš„æ•°é‡åœ¨æ¯æ¬¡ä¸€æ‰¹é¾™ç ä»ä¸€ä¸ªåŸå¸‚åˆ°å¦ä¸€ä¸ªåŸå¸‚ï¼Œæ•°é‡è½¬ç§»ä¹Ÿå¾ˆå¥½æ±‚å‡ºæ¥</p>
<p>é¾™ç èµ°äº†å‡ æ¬¡ï¼Œå¹¶æŸ¥é›†å†™æ³•ï¼šæ¯ä¸ªç‚¹èµ°çš„æ€»è·¯ç¨‹&#x3D;å®ƒçš„çˆ¶èŠ‚ç‚¹èµ°çš„æ€»è·¯ç¨‹+1</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> fa[N];      <span class="comment">//è®°å½•æ¯ä¸ªç‚¹çš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line"><span class="type">int</span> ba[N];      <span class="comment">//è®°å½•æ¯ä¸ªåŸå¸‚</span></span><br><span class="line"><span class="type">int</span> ra[N];      <span class="comment">//è®°å½•æ¯ä¸ªç‚¹ç§»åŠ¨çš„æ¬¡æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x==fa[x])<span class="keyword">return</span> x;</span><br><span class="line">    <span class="type">int</span> t=fa[x];</span><br><span class="line">    fa[x]=<span class="built_in">find</span>(fa[x]);</span><br><span class="line">    ra[x]+=ra[t];</span><br><span class="line">    <span class="keyword">return</span> fa[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    u=<span class="built_in">find</span>(u),v=<span class="built_in">find</span>(v);</span><br><span class="line">    <span class="keyword">if</span>(u==v)<span class="keyword">return</span>;</span><br><span class="line">    fa[u]=v;</span><br><span class="line">    ra[u]++;</span><br><span class="line">    ba[v]+=ba[u],ba[u]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin&gt;&gt;t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=t;j++)&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;Case &quot;</span>&lt;&lt;j&lt;&lt;<span class="string">&quot;:\n&quot;</span>;</span><br><span class="line">        <span class="type">int</span> n,m;</span><br><span class="line">        cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)fa[i]=i,ra[i]=<span class="number">0</span>,ba[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">            <span class="type">char</span> c;</span><br><span class="line">            cin&gt;&gt;c;</span><br><span class="line">            <span class="keyword">if</span>(c==<span class="string">&#x27;T&#x27;</span>)&#123;</span><br><span class="line">                <span class="type">int</span> u,v;</span><br><span class="line">                cin&gt;&gt;u&gt;&gt;v;</span><br><span class="line">                <span class="built_in">merge</span>(u,v);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="type">int</span> x;</span><br><span class="line">                cin&gt;&gt;x;</span><br><span class="line">                <span class="type">int</span> u=<span class="built_in">find</span>(x);</span><br><span class="line">                cout&lt;&lt;u&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;ba[u]&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;ra[x]&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="æ ‘çŠ¶æ•°ç»„"><a href="#æ ‘çŠ¶æ•°ç»„" class="headerlink" title="æ ‘çŠ¶æ•°ç»„"></a>æ ‘çŠ¶æ•°ç»„</h1><p>å¯ä»¥è§£å†³å¤§éƒ¨åˆ†åŸºäºåŒºé—´ä¸Šçš„æ›´æ–°ä»¥åŠæ±‚å’Œé—®é¢˜ã€‚</p>
<p>å®šä¹‰ä¸€ä¸ªåŒºé—´[ l , r ]ï¼Œå…¶ä¸­updateå·¦ç«¯ç‚¹ï¼Œåˆ™æ¯” l å¤§çš„åŒºé—´éƒ½åŠ  kã€‚æ±‚å€¼çš„æ—¶å€™sumå³ç«¯ç‚¹å¾—åˆ°çš„æ˜¯æ‰€æœ‰åœ¨åŒºé—´å†…çš„å’Œåœ¨åŒºé—´å¤–çš„ï¼Œsumå·¦ç«¯ç‚¹å¾—åˆ°çš„æ˜¯æ‰€æœ‰åœ¨åŒºé—´å¤–çš„ï¼Œå‡ä¸€å‡å³æ˜¯åŒºé—´å†…çš„å€¼ã€‚</p>
<p>æ ‘çŠ¶æ•°ç»„æ˜¯å¾€å°çš„å–å€¼ã€‚</p>
<h2 id="ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜"><a href="#ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜" class="headerlink" title="ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜"></a><a href="https://www.acwing.com/problem/content/248/">ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šé•¿åº¦ä¸º N çš„æ•°åˆ— Aï¼Œç„¶åè¾“å…¥ M è¡Œæ“ä½œæŒ‡ä»¤ã€‚</p>
<p>ç¬¬ä¸€ç±»æŒ‡ä»¤å½¢å¦‚ C l r dï¼Œè¡¨ç¤ºæŠŠæ•°åˆ—ä¸­ç¬¬ lâˆ¼r ä¸ªæ•°éƒ½åŠ  dã€‚</p>
<p>ç¬¬äºŒç±»æŒ‡ä»¤å½¢å¦‚ Q xï¼Œè¡¨ç¤ºè¯¢é—®æ•°åˆ—ä¸­ç¬¬ x ä¸ªæ•°çš„å€¼ã€‚</p>
<p>å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œè¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>ç»™ l ç«¯ç‚¹update(d)ï¼Œr ç«¯ç‚¹update(-d)ï¼ŒæŸ¥è¯¢[l,r]åŒºé—´å†…çš„ç«¯ç‚¹çš„æ—¶å€™å®ƒä¼šåŠ ä¸Šdï¼ŒæŸ¥è¯¢åŒºé—´åçš„ç«¯ç‚¹çš„æ—¶å€™å®ƒä¸å—å½±å“ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,q,a[N],c[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(x&lt;=n)&#123;</span><br><span class="line">		c[x]+=k;</span><br><span class="line">		x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> r=a[x];</span><br><span class="line">	<span class="keyword">while</span>(x)&#123;</span><br><span class="line">		r+=c[x];</span><br><span class="line">		x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> u,v,x;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(q--)&#123;</span><br><span class="line">		<span class="type">char</span> c;</span><br><span class="line">		cin&gt;&gt;c;</span><br><span class="line">		<span class="keyword">if</span>(c==<span class="string">&#x27;Q&#x27;</span>)&#123;</span><br><span class="line">			cin&gt;&gt;u;</span><br><span class="line">			cout&lt;&lt;<span class="built_in">sum</span>(u)&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			cin&gt;&gt;u&gt;&gt;v&gt;&gt;x;</span><br><span class="line">			<span class="built_in">update</span>(u,x);</span><br><span class="line">			<span class="built_in">update</span>(v+<span class="number">1</span>,-x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2"><a href="#ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2" class="headerlink" title="ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2"></a><a href="https://www.acwing.com/problem/content/244/">ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º N çš„æ•°åˆ— Aï¼Œä»¥åŠ M æ¡æŒ‡ä»¤ï¼Œæ¯æ¡æŒ‡ä»¤å¯èƒ½æ˜¯ä»¥ä¸‹ä¸¤ç§ä¹‹ä¸€ï¼š</p>
<ol>
<li>C l r dï¼Œè¡¨ç¤ºæŠŠ A[l],A[l+1],â€¦,A[r] éƒ½åŠ ä¸Š dã€‚</li>
<li>Q l rï¼Œè¡¨ç¤ºè¯¢é—®æ•°åˆ—ä¸­ç¬¬ lâˆ¼r ä¸ªæ•°çš„å’Œã€‚</li>
</ol>
<p>å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œè¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>æ•°ç»„bå­˜å‚¨ i * d[i]ï¼Œjï¼Œæ•°ç»„cå­˜å‚¨ d[i]</p>
<p>è®¾a[i]è¡¨ç¤ºç¬¬iä¸ªæ•°çš„å€¼ï¼Œd[i]ä¸ºå·®åˆ†æ•°ç»„dç­‰äºa[i]-a[i-1]<br> a[1]&#x3D;d[1]<br> a[2]&#x3D;d[1]+d[2]<br> Â·Â·Â·Â·Â·Â·<br> a[x]&#x3D;d[1]+d[2]+â€¦+a[x]<br> åˆ™a[1]+a[2]+â€¦+a[x]&#x3D;x$<em>$d[1]+(x-1)$</em>$d[2]+â€¦+d[x]<br>           &#x3D;(x+1)$<em>$(d[1]+d[2]+â€¦+d[x])-(1</em>d[1]+2<em>d[2]+â€¦+x</em>d[x])<br>           &#x3D;(x+1)Î£d[i]-Î£i*d[i]  (iä»1åˆ°x)</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> b[N],c[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> p=k*x;</span><br><span class="line">	<span class="keyword">while</span>(x&lt;N)&#123;</span><br><span class="line">		c[x]+=k;</span><br><span class="line">		b[x]+=p;</span><br><span class="line">		x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> r=<span class="number">0</span>,p=x+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(x)&#123;</span><br><span class="line">		r+=p*c[x]-b[x];</span><br><span class="line">		x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> n,m;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">	<span class="type">int</span> now,pre=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;now;</span><br><span class="line">		<span class="built_in">update</span>(i,now-pre);</span><br><span class="line">		pre=now;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(m--)&#123;</span><br><span class="line">		<span class="type">char</span> c;</span><br><span class="line">		<span class="type">int</span> u,v,x;</span><br><span class="line">		cin&gt;&gt;c;</span><br><span class="line">		<span class="keyword">if</span>(c==<span class="string">&#x27;Q&#x27;</span>)&#123;</span><br><span class="line">			cin&gt;&gt;u&gt;&gt;v;</span><br><span class="line">			cout&lt;&lt;<span class="built_in">sum</span>(v)-<span class="built_in">sum</span>(u<span class="number">-1</span>)&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			cin&gt;&gt;u&gt;&gt;v&gt;&gt;x;</span><br><span class="line">			<span class="built_in">update</span>(u,x);</span><br><span class="line">			<span class="built_in">update</span>(v+<span class="number">1</span>,-x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ¥¼å…°å›¾è…¾"><a href="#æ¥¼å…°å›¾è…¾" class="headerlink" title="æ¥¼å…°å›¾è…¾"></a><a href="https://www.acwing.com/problem/content/submission/243/">æ¥¼å…°å›¾è…¾</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>è¥¿éƒ¨ 314 åœ¨æ¥¼å…°å¤åŸçš„ä¸‹é¢å‘ç°äº†ä¸€å¹…å·¨å¤§çš„å£ç”»ï¼Œå£ç”»ä¸Šè¢«æ ‡è®°å‡ºäº† n ä¸ªç‚¹ï¼Œç»æµ‹é‡å‘ç°è¿™ n ä¸ªç‚¹çš„æ°´å¹³ä½ç½®å’Œç«–ç›´ä½ç½®æ˜¯ä¸¤ä¸¤ä¸åŒçš„ã€‚</p>
<p>è¥¿éƒ¨ 314 è®¤ä¸ºè¿™å¹…å£ç”»æ‰€åŒ…å«çš„ä¿¡æ¯ä¸è¿™ n ä¸ªç‚¹çš„ç›¸å¯¹ä½ç½®æœ‰å…³ï¼Œå› æ­¤ä¸å¦¨è®¾åæ ‡åˆ†åˆ«ä¸º (1,y1),(2,y2),â€¦,(n,yn)ï¼Œå…¶ä¸­ y1âˆ¼yn æ˜¯ 1 åˆ° n çš„ä¸€ä¸ªæ’åˆ—ã€‚</p>
<p>è¥¿éƒ¨ 314 æ‰“ç®—ç ”ç©¶è¿™å¹…å£ç”»ä¸­åŒ…å«ç€å¤šå°‘ä¸ªå›¾è…¾ã€‚</p>
<p>å¦‚æœä¸‰ä¸ªç‚¹ (i,yi),(j,yj),(k,yk) æ»¡è¶³ 1â‰¤i&lt;j&lt;kâ‰¤n1 ä¸” yi&gt;yj,yj&lt;ykï¼Œåˆ™ç§°è¿™ä¸‰ä¸ªç‚¹æ„æˆ V å›¾è…¾;</p>
<p>å¦‚æœä¸‰ä¸ªç‚¹ (i,yi),(j,yj),(k,yk) æ»¡è¶³ 1â‰¤i&lt;j&lt;kâ‰¤n1 ä¸” yi&lt;yj,yj&gt;ykï¼Œåˆ™ç§°è¿™ä¸‰ä¸ªç‚¹æ„æˆ âˆ§ å›¾è…¾;</p>
<p>è¥¿éƒ¨ 314 æƒ³çŸ¥é“ï¼Œè¿™ n ä¸ªç‚¹ä¸­ä¸¤ä¸ªéƒ¨è½å›¾è…¾çš„æ•°ç›®ã€‚</p>
<p>å› æ­¤ï¼Œä½ éœ€è¦ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥æ±‚å‡º V çš„ä¸ªæ•°å’Œ âˆ§ çš„ä¸ªæ•°ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>å…ˆæ±‚æ¯ä¸ªç‚¹å‰åæ¯”å®ƒå°çš„æ•°é‡å’Œæ¯”å®ƒå¤§çš„æ•°é‡ï¼Œå‰é¢æ¯”å®ƒå°çš„æ•°é‡ * åé¢æ¯”å®ƒå°çš„æ•°é‡å°±æ˜¯ ^ çš„ä¸ªæ•°ï¼Œåä¹‹å‰é¢æ¯”å®ƒå¤§çš„æ•°é‡ * åé¢æ¯”å®ƒå¤§çš„æ•°é‡å°±æ˜¯ V çš„ä¸ªæ•°ï¼Œè¿™æ ·å³å¯æ±‚å¾—ç­”æ¡ˆã€‚</p>
<p>ç”¨æ ‘çŠ¶æ•°ç»„çš„æ–¹æ³•ï¼Œæ±‚å‰é¢æ¯”å®ƒå°çš„ï¼Œå…ˆå°†å‰é¢çš„æ•°å­˜è¿›å»ï¼›æ±‚åé¢æ¯”å®ƒå°çš„ï¼Œå…ˆå°†åé¢çš„æ•°å­˜è¿›å»ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> l_up[N],l_down[N];</span><br><span class="line"><span class="type">int</span> r_up[N],r_down[N];</span><br><span class="line"><span class="type">int</span> a[N],c[N],n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(x&lt;=n)&#123;</span><br><span class="line">		c[x]++;</span><br><span class="line">		x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x)&#123;</span><br><span class="line">		r+=c[x];</span><br><span class="line">		x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;a[i];</span><br><span class="line">		l_down[i]=<span class="built_in">sum</span>(a[i]);		<span class="comment">//å‰é¢æ¯”å®ƒå°çš„æ•°</span></span><br><span class="line">		l_up[i]=i<span class="number">-1</span>-l_down[i];</span><br><span class="line">		<span class="built_in">update</span>(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="keyword">sizeof</span> c);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;<span class="number">0</span>;i--)&#123;</span><br><span class="line">		r_down[i]=<span class="built_in">sum</span>(a[i]);</span><br><span class="line">		r_up[i]=n-i-r_down[i];</span><br><span class="line">		<span class="built_in">update</span>(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> ans1=<span class="number">0</span>,ans2=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		ans1+=l_down[i]*r_down[i];</span><br><span class="line">		ans2+=l_up[i]*r_up[i];</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;ans2&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;ans1;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è°œä¸€æ ·çš„ç‰›-äºŒåˆ†"><a href="#è°œä¸€æ ·çš„ç‰›-äºŒåˆ†" class="headerlink" title="è°œä¸€æ ·çš„ç‰›(äºŒåˆ†)"></a><a href="https://www.acwing.com/problem/content/245/">è°œä¸€æ ·çš„ç‰›(äºŒåˆ†)</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>æœ‰ n å¤´å¥¶ç‰›ï¼Œå·²çŸ¥å®ƒä»¬çš„èº«é«˜ä¸º 1âˆ¼n ä¸”å„ä¸ç›¸åŒï¼Œä½†ä¸çŸ¥é“æ¯å¤´å¥¶ç‰›çš„å…·ä½“èº«é«˜ã€‚</p>
<p>ç°åœ¨è¿™ n å¤´å¥¶ç‰›ç«™æˆä¸€åˆ—ï¼Œå·²çŸ¥ç¬¬ i å¤´ç‰›å‰é¢æœ‰ Ai å¤´ç‰›æ¯”å®ƒä½ï¼Œæ±‚æ¯å¤´å¥¶ç‰›çš„èº«é«˜ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>æ ‘çŠ¶æ•°ç»„ + äºŒåˆ†</p>
<p>å› ä¸ºèº«é«˜ä¸º 1~n æ‰€ä»¥ä¸€å¼€å§‹æ¯ä¸ªç‚¹éƒ½ +1ï¼Œä»åå¾€å‰ï¼Œé€šè¿‡äºŒåˆ†å¾—å‡ºè¿™ä¸ªç‚¹çš„èº«é«˜æ˜¯å¤šå°‘ï¼Œç„¶åè¿™ä¸ªç‚¹å·²ç»è¢«é€‰äº†ï¼Œæ‰€ä»¥è¿™ä¸ªèº«é«˜ -1ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,a[N],c[N],res[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(x&lt;=n)&#123;</span><br><span class="line">		c[x]+=k;</span><br><span class="line">		x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x)&#123;</span><br><span class="line">		r+=c[x];</span><br><span class="line">		x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;a[i];</span><br><span class="line">		<span class="built_in">update</span>(i,<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;<span class="number">0</span>;i--)&#123;</span><br><span class="line">		<span class="type">int</span> l=<span class="number">1</span>,r=n,ans;</span><br><span class="line">		<span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">			<span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">sum</span>(mid)&gt;=a[i])ans=mid,r=mid<span class="number">-1</span>;</span><br><span class="line">			<span class="keyword">else</span> l=mid+<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		res[i]=ans;</span><br><span class="line">		<span class="built_in">update</span>(ans,<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)cout&lt;&lt;res[i]&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è‹¹æœæ ‘"><a href="#è‹¹æœæ ‘" class="headerlink" title="è‹¹æœæ ‘"></a><a href="http://poj.org/problem?id=3321">è‹¹æœæ ‘</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>å¡å¡å®¶é—¨å¤–æœ‰ä¸€æ£µè‹¹æœæ ‘ã€‚æ¯å¹´ç§‹å¤©ï¼Œæ ‘ä¸Šéƒ½ä¼šé•¿å‡ºå¾ˆå¤šè‹¹æœã€‚å¡å¡éå¸¸å–œæ¬¢è‹¹æœï¼Œæ‰€ä»¥ä»–ä¸€ç›´åœ¨ç²¾å¿ƒåŸ¹è‚²å¤§è‹¹æœæ ‘ã€‚</p>
<p>è¿™æ£µæ ‘æœ‰<em>N</em>ä¸ªåˆ†å‰ï¼Œç”±æ ‘æè¿æ¥ã€‚å¡å¡å°†å‰å­ç¼–å·ä¸º 1 åˆ° <em>N</em>ï¼Œæ ¹å§‹ç»ˆç¼–å·ä¸º 1ã€‚è‹¹æœä¼šåœ¨å‰å­ä¸Šç”Ÿé•¿ï¼Œä¸¤ä¸ªè‹¹æœä¸ä¼šåœ¨åŒä¸€ä¸ªå‰å­ä¸Šç”Ÿé•¿ã€‚å¡å¡æƒ³çŸ¥é“ä¸€ä¸ªå­æ ‘ä¸­æœ‰å¤šå°‘ä¸ªè‹¹æœï¼Œç”¨äºç ”ç©¶è‹¹æœæ ‘çš„ç”Ÿäº§èƒ½åŠ›ã€‚</p>
<p>éº»çƒ¦çš„æ˜¯ï¼Œä¸€ä¸ªæ–°çš„è‹¹æœå¯èƒ½ä¼šåœ¨ç©ºå‰å­ä¸Šç”Ÿé•¿ä¸€æ®µæ—¶é—´ï¼Œå¡å¡å¯èƒ½ä¼šä»æ ‘ä¸Šæ‘˜ä¸‹ä¸€ä¸ªè‹¹æœä½œä¸ºä»–çš„ç”œç‚¹ã€‚ä½ èƒ½å¸®åŠ©å¡å¡å—ï¼Ÿ</p>
<p><strong>æ€è·¯</strong></p>
<p>ä»æ ¹èŠ‚ç‚¹dfsï¼Œç»™èŠ‚ç‚¹çš„èµ·ç‚¹å’Œç»ˆç‚¹å»ºç«‹ä¸‹æ ‡ï¼ˆèµ·ç‚¹ä¸€å®šæ¯”ç»ˆç‚¹çš„ä¸‹æ ‡å°ï¼Œçˆ¶èŠ‚ç‚¹çš„èµ·ç‚¹ä¸€å®šå°äºå­èŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹çš„ç»ˆç‚¹ä¸€å®šå¤§äºå­èŠ‚ç‚¹ï¼‰ï¼Œæ›´æ–°æ¯æ¬¡ä»èµ·ç‚¹å¼€å§‹éå†ï¼Œè¾“å‡ºç»“æœä»ç»ˆç‚¹ - èµ·ç‚¹å‰ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ç»ˆç‚¹ä¸€å®šåœ¨æ‰€æœ‰çˆ¶èŠ‚ç‚¹çš„å‰é¢ï¼Œèµ·ç‚¹ä¸€å®šåœ¨æ‰€æœ‰çˆ¶èŠ‚ç‚¹çš„åé¢ï¼Œæ‰€ä»¥ç»ˆç‚¹sumçš„å€¼åŒ…å«çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ï¼Œè€Œèµ·ç‚¹sumçš„å€¼åªåŒ…å«çˆ¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥è§ä¸€ä¸‹å°±æ˜¯å­èŠ‚ç‚¹çš„å€¼ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[N&lt;&lt;<span class="number">1</span>],from[N&lt;&lt;<span class="number">1</span>],head[N],idx;</span><br><span class="line"><span class="type">int</span> vis[N],tot,d[N][<span class="number">2</span>],b[N],c[N];</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	to[idx]=v,from[idx]=head[u],head[u]=idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">	d[u][<span class="number">0</span>]=++tot;		<span class="comment">//æ ¹èŠ‚ç‚¹å¼€å§‹çš„totçš„å€¼ä¸€å®šæ¯”å­æ ‘çš„å°</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=head[u];i!=<span class="number">-1</span>;i=from[i])&#123;</span><br><span class="line">		<span class="type">int</span> j=to[i];</span><br><span class="line">		<span class="keyword">if</span>(vis[j])<span class="keyword">continue</span>;</span><br><span class="line">		vis[j]=<span class="number">1</span>;</span><br><span class="line">		<span class="built_in">dfs</span>(j);</span><br><span class="line">	&#125;</span><br><span class="line">	d[u][<span class="number">1</span>]=tot;		<span class="comment">//æ ¹èŠ‚ç‚¹ç»“æŸçš„totçš„å€¼ä¸€å®šæ¯”å­æ ‘çš„å¤§</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	c[x]*=<span class="number">-1</span>;</span><br><span class="line">	<span class="type">int</span> k=c[x];</span><br><span class="line">	x=d[x][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">while</span>(x&lt;=n)&#123;</span><br><span class="line">		b[x]+=k;</span><br><span class="line">		x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x)&#123;</span><br><span class="line">		r+=b[x];</span><br><span class="line">		x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span> head);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="type">int</span> u,v;</span><br><span class="line">		cin&gt;&gt;u&gt;&gt;v;</span><br><span class="line">		<span class="built_in">add</span>(u,v);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		c[i]=<span class="number">-1</span>;</span><br><span class="line">		<span class="built_in">update</span>(i);</span><br><span class="line">	&#125;</span><br><span class="line">	cin&gt;&gt;m;</span><br><span class="line">	<span class="keyword">while</span>(m--)&#123;</span><br><span class="line">		<span class="type">char</span> c;</span><br><span class="line">		<span class="type">int</span> x;</span><br><span class="line">		cin&gt;&gt;c&gt;&gt;x;</span><br><span class="line">		<span class="keyword">if</span>(c==<span class="string">&#x27;Q&#x27;</span>)cout&lt;&lt;<span class="built_in">sum</span>(d[x][<span class="number">1</span>])-<span class="built_in">sum</span>(d[x][<span class="number">0</span>]<span class="number">-1</span>)&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;		<span class="comment">//è¦è¾“å‡ºçš„æ˜¯å­æ ‘ï¼Œæ‰€ä»¥æ ¹èŠ‚ç‚¹çš„èŒƒå›´æœ€å¤§</span></span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">update</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¥‡æ€ªçš„çº¿æ®µ"><a href="#å¥‡æ€ªçš„çº¿æ®µ" class="headerlink" title="å¥‡æ€ªçš„çº¿æ®µ"></a><a href="https://www.lanqiao.cn/problems/5131/learning/?contest_id=144">å¥‡æ€ªçš„çº¿æ®µ</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>åœ¨ä¸€ç»´æ•°è½´ä¸Šï¼Œå°è“ç”»äº†nä¸ªé—­åŒºé—´çº¿æ®µï¼Œå°æ¡¥ä¼šå¤šæ¬¡è¯¢é—®ä½ ï¼Œæ¯æ¬¡ç»™å®šä¸¤ä¸ªç‚¹aï¼Œbï¼Œé—®æœ‰å¤šå°‘ä¸ªåŒºé—´åŒ…å«aç‚¹ï¼Œä½†æ˜¯ä¸åŒ…å«bç‚¹ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>å®¹æ–¥åŸç†ï¼ŒåŒ…å«açš„åŒºé—´ - åŒ…å«[a,b]çš„åŒºé—´ã€‚å³ç«¯ç‚¹åçš„æ’å‰é¢ï¼Œè¿™æ ·æ¯æ¬¡æŸ¥è¯¢åŒºé—´[a,b]çš„æ—¶å€™ï¼Œæ»¡è¶³å·¦ç«¯åœ¨å®ƒå‰é¢çš„å®ƒå³ç«¯ä¸€å®šåœ¨å®ƒåé¢ï¼Œæ‰€ä»¥åªè¦æ»¡è¶³å·¦ç«¯åœ¨å®ƒå‰é¢çš„åŒºé—´çš„æ•°é‡&#x3D;&#x3D;åŒ…å«è¯¥åŒºé—´çš„æ‰€æœ‰é—­åŒºé—´æ•°é‡ï¼ŒåŒ…å«aç‚¹çš„åŒºé—´åˆä¸€å¼€å§‹å°±ç»™å¥½äº†ï¼Œæ‰€ä»¥æ˜“å¾—ç»“æœã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> d[N],res[N],c[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r;</span><br><span class="line">	<span class="type">int</span> id,op;</span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node&amp;b)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(r!=b.r)<span class="keyword">return</span> r&gt;b.r;		<span class="comment">//å³ç«¯å¤§çš„æ’å‰é¢</span></span><br><span class="line">		<span class="keyword">if</span>(l!=b.l)<span class="keyword">return</span> l&lt;b.l;		<span class="comment">//å³ç«¯ä¸€æ ·å¤§ï¼Œå·¦ç«¯å°çš„æ’å‰é¢</span></span><br><span class="line">		<span class="keyword">return</span> op&lt;b.op;				<span class="comment">//å·¦å³ä¸¤ç«¯éƒ½ä¸€æ ·å¤§ï¼Œä¸æ˜¯æŸ¥è¯¢åŒºé—´çš„æ’å‰é¢</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;nb[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(x&lt;N)&#123;</span><br><span class="line">		c[x]++;</span><br><span class="line">		x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x)&#123;</span><br><span class="line">		r+=c[x];</span><br><span class="line">		x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> n,q;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">	<span class="type">int</span> l,r;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;l&gt;&gt;r;</span><br><span class="line">		d[l]++,d[r+<span class="number">1</span>]--;</span><br><span class="line">		nb[i]=&#123;l,r,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;N;i++)d[i]+=d[i<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</span><br><span class="line">		cin&gt;&gt;l&gt;&gt;r;</span><br><span class="line">		res[i]=d[l];</span><br><span class="line">		<span class="keyword">if</span>(l&gt;r)<span class="built_in">swap</span>(l,r);</span><br><span class="line">		nb[++n]=&#123;l,r,i,<span class="number">1</span>&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(nb+<span class="number">1</span>,nb+<span class="number">1</span>+n);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(nb[i].op==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">add</span>(nb[i].l);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			res[nb[i].id]-=<span class="built_in">sum</span>(nb[i].l);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;i++)cout&lt;&lt;res[i]&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="é€†åºå¯¹çš„æ•°é‡"><a href="#é€†åºå¯¹çš„æ•°é‡" class="headerlink" title="é€†åºå¯¹çš„æ•°é‡"></a><a href="https://www.acwing.com/problem/content/790/">é€†åºå¯¹çš„æ•°é‡</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°æ•°åˆ—ï¼Œè¯·ä½ è®¡ç®—æ•°åˆ—ä¸­çš„é€†åºå¯¹çš„æ•°é‡ã€‚</p>
<p>é€†åºå¯¹çš„å®šä¹‰å¦‚ä¸‹ï¼šå¯¹äºæ•°åˆ—çš„ç¬¬ i ä¸ªå’Œç¬¬ j ä¸ªå…ƒç´ ï¼Œå¦‚æœæ»¡è¶³ i&lt;j ä¸” a[i]&gt;a[j]ï¼Œåˆ™å…¶ä¸ºä¸€ä¸ªé€†åºå¯¹ï¼›å¦åˆ™ä¸æ˜¯ã€‚</p>
<p>1â‰¤nâ‰¤100000ï¼Œ<br>æ•°åˆ—ä¸­çš„å…ƒç´ çš„å–å€¼èŒƒå›´ [1,1e9]ã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>å…ƒç´ å–å€¼è¿‡å¤§ï¼Œä½†æ•°é‡å°‘ï¼Œå¯ä»¥ç¦»æ•£åŒ–ï¼Œå°†å…ƒç´ å€¼ç”¨ä¸‹æ ‡è¡¨ç¤ºã€‚</p>
<p>å› ä¸ºæ ‘çŠ¶æ•°ç»„æ˜¯å¾€å°çš„å–å€¼ï¼Œæ‰€ä»¥sumæ‰€å¾—çš„æ˜¯ä¸‹æ ‡å°çš„æ•°é‡ï¼Œæ‰€ä»¥åº”è¯¥å°†å…ƒç´ å€¼å¤§çš„æ’å‰é¢ï¼Œå¦‚æœå€¼ç›¸åŒï¼Œä¸‹æ ‡å¤§çš„æ’å‰é¢ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,c[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> a,b;</span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node&amp;x)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(a==x.a)<span class="keyword">return</span> b&gt;x.b;</span><br><span class="line">		<span class="keyword">return</span> a&gt;x.a;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;nb[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(x&lt;=n)&#123;</span><br><span class="line">		c[x]++;</span><br><span class="line">		x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x)&#123;</span><br><span class="line">		r+=c[x];</span><br><span class="line">		x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;nb[i].a;</span><br><span class="line">		nb[i].b=i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(nb+<span class="number">1</span>,nb+<span class="number">1</span>+n);</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		ans+=<span class="built_in">sum</span>(nb[i].b);</span><br><span class="line">		<span class="built_in">update</span>(nb[i].b);</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="çŸ©é˜µ-äºŒç»´"><a href="#çŸ©é˜µ-äºŒç»´" class="headerlink" title="çŸ©é˜µ(äºŒç»´)"></a><a href="http://poj.org/problem?id=2155"><strong>çŸ©é˜µ</strong>(äºŒç»´)</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ª N*N çŸ©é˜µ Aï¼Œå…¶å…ƒç´ ä¸º 0 æˆ– 1ã€‚A[iï¼Œ j] è¡¨ç¤ºç¬¬ i è¡Œå’Œç¬¬ j åˆ—ä¸­çš„æ•°å­—ã€‚æœ€åˆæˆ‘ä»¬æœ‰ A[iï¼Œ j] &#x3D; 0 ï¼ˆ1 &lt;&#x3D; iï¼Œ j &lt;&#x3D; Nï¼‰ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ›´æ”¹çŸ©é˜µã€‚ç»™å®šä¸€ä¸ªå·¦ä¸Šè§’ä¸º ï¼ˆx1ï¼Œ y1ï¼‰ ä¸”å³ä¸‹è§’ä¸º ï¼ˆx2ï¼Œ y2ï¼‰ çš„çŸ©å½¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ â€œnotâ€ æ“ä½œæ›´æ”¹çŸ©å½¢ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆå¦‚æœå®ƒæ˜¯ â€˜0â€™ åˆ™å°†å…¶æ›´æ”¹ä¸º â€˜1â€™ï¼Œå¦åˆ™å°†å…¶æ›´æ”¹ä¸º â€˜0â€™ï¼‰ã€‚ä¸ºäº†ç»´æŠ¤çŸ©é˜µçš„ä¿¡æ¯ï¼Œè¦æ±‚æ‚¨ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥æ¥æ”¶å’Œæ‰§è¡Œä¸¤ç§æŒ‡ä»¤ã€‚</p>
<ol>
<li>C x1 y1 x2 y2 ï¼ˆ1 &lt;&#x3D; x1 &lt;&#x3D; x2 &lt;&#x3D; nï¼Œ 1 &lt;&#x3D; y1 &lt;&#x3D; y2 &lt;&#x3D; nï¼‰ é€šè¿‡ä½¿ç”¨å·¦ä¸Šè§’ä¸º ï¼ˆx1ï¼Œ y1ï¼‰ ä¸”å³ä¸‹è§’ä¸º ï¼ˆx2ï¼Œ y2ï¼‰ çš„çŸ©å½¢æ›´æ”¹çŸ©é˜µã€‚</li>
<li>Q x y ï¼ˆ1 &lt;&#x3D; xï¼Œ y &lt;&#x3D; nï¼‰ æŸ¥è¯¢ A[xï¼Œ y]ã€‚</li>
</ol>
<p><strong>æ€è·¯</strong></p>
<p>äºŒç»´çœ‹ï¼Œ[ a, b ]åˆ°[ c, d ]ï¼Œä¸€ç»´ a åˆ° c è·Ÿæ–°çš„è¯ï¼Œåº”è¯¥update(a)å†update(c+1,-1)ï¼ŒäºŒç»´åŸç†ä¸€æ ·ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,c[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=x;i&lt;=n;i+=<span class="built_in">lowbit</span>(i))&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=y;j&lt;=n;j+=<span class="built_in">lowbit</span>(j))&#123;</span><br><span class="line">			c[i][j]+=k;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=x;i;i-=<span class="built_in">lowbit</span>(i))&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=y;j;j-=<span class="built_in">lowbit</span>(j))&#123;</span><br><span class="line">			res+=c[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res%<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t,q;</span><br><span class="line">	cin&gt;&gt;t;</span><br><span class="line">	<span class="keyword">while</span>(t--)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="keyword">sizeof</span> c);</span><br><span class="line">		cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">		<span class="keyword">while</span>(q--)&#123;</span><br><span class="line">			<span class="type">char</span> c;</span><br><span class="line">			cin&gt;&gt;c;</span><br><span class="line">			<span class="keyword">if</span>(c==<span class="string">&#x27;C&#x27;</span>)&#123;</span><br><span class="line">				<span class="type">int</span> xx1,yy1,xx2,yy2;</span><br><span class="line">				cin&gt;&gt;xx1&gt;&gt;yy1&gt;&gt;xx2&gt;&gt;yy2;</span><br><span class="line">				<span class="built_in">update</span>(xx1,yy1,<span class="number">1</span>);</span><br><span class="line">				<span class="built_in">update</span>(xx2+<span class="number">1</span>,yy2+<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">				<span class="built_in">update</span>(xx1,yy2+<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">				<span class="built_in">update</span>(xx2+<span class="number">1</span>,yy1,<span class="number">-1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> x,y;</span><br><span class="line">				cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">				cout&lt;&lt;<span class="built_in">sum</span>(x,y)&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h1><p>çº¿æ®µæ ‘å­˜çš„æ˜¯ä¸€ä¸ªåŒºé—´é‡Œçš„å€¼</p>
<p><img src="https://cdn.acwing.com/media/article/image/2022/08/26/109870_82ea7ce424-tmp.jpg" alt="img"></p>
<h2 id="æœ€å¤§æ•°"><a href="#æœ€å¤§æ•°" class="headerlink" title="æœ€å¤§æ•°"></a><a href="https://www.acwing.com/problem/content/1277/">æœ€å¤§æ•°</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°åˆ— a1,a2,â€¦,anï¼Œæ¯ä¸€ä¸ªæ•°éƒ½åœ¨ 0âˆ¼pâˆ’1 ä¹‹é—´ã€‚</p>
<p>å¯ä»¥å¯¹è¿™åˆ—æ•°è¿›è¡Œä¸¤ç§æ“ä½œï¼š</p>
<ol>
<li>æ·»åŠ æ“ä½œï¼šå‘åºåˆ—åæ·»åŠ ä¸€ä¸ªæ•°ï¼Œåºåˆ—é•¿åº¦å˜æˆ n+1ï¼›</li>
<li>è¯¢é—®æ“ä½œï¼šè¯¢é—®è¿™ä¸ªåºåˆ—ä¸­æœ€å L ä¸ªæ•°ä¸­æœ€å¤§çš„æ•°æ˜¯å¤šå°‘ã€‚</li>
</ol>
<p>ç¨‹åºè¿è¡Œçš„æœ€å¼€å§‹ï¼Œæ•´æ•°åºåˆ—ä¸ºç©ºã€‚</p>
<p>ä¸€å…±è¦å¯¹æ•´æ•°åºåˆ—è¿›è¡Œ m æ¬¡æ“ä½œã€‚</p>
<p>å†™ä¸€ä¸ªç¨‹åºï¼Œè¯»å…¥æ“ä½œçš„åºåˆ—ï¼Œå¹¶è¾“å‡ºè¯¢é—®æ“ä½œçš„ç­”æ¡ˆã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>å…ˆå»ºæ ‘ï¼Œå› ä¸ºmæ¬¡æ“ä½œï¼Œæ‰€ä»¥æ ‘çš„æœ€å¤§å€¼åº”è¯¥ä¸è¶…è¿‡mã€‚æ¯ä¸ªèŠ‚ç‚¹è®°å½•å·¦å­èŠ‚ç‚¹çš„åŒºé—´å·¦ç«¯å’Œå³å­èŠ‚ç‚¹çš„åŒºé—´å³ç«¯ï¼Œä»¥åŠè‡ªèº«æ‰€å¸¦çš„å€¼ã€‚</p>
<p>å› ä¸ºå…ˆæ·»åŠ å¦‚æœè¢«æŸ¥è¯¢çš„è¯ï¼Œåæ·»åŠ çš„ä¸€å®šå·²ç»è¢«æŸ¥è¯¢äº†ï¼Œæ‰€ä»¥å…ˆæ·»åŠ çš„æ”¾å‰é¢ï¼Œæ‰¾æœ€å¤§çš„æ—¶å€™ï¼Œå–n-x+1å³æ˜¯æ‰¾æœ€å x ä¸ªæ•°å†…çš„æœ€å¤§å€¼ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r,w;</span><br><span class="line">&#125;tr[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	tr[u]=&#123;l,r,<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">if</span>(l==r)<span class="keyword">return</span>;</span><br><span class="line">	<span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">	<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">	tr[u].w=<span class="built_in">max</span>(tr[u&lt;&lt;<span class="number">1</span>].w,tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> p,<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l==p&amp;&amp;tr[u].r==p)tr[u].w=x;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="type">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(p&lt;=mid)<span class="built_in">add</span>(u&lt;&lt;<span class="number">1</span>,p,x);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">add</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,p,x);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)<span class="keyword">return</span> tr[u].w;</span><br><span class="line">	<span class="type">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>,v=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(l&lt;=mid)v=<span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">	<span class="keyword">if</span>(r&gt;mid)v=<span class="built_in">max</span>(v,<span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r));</span><br><span class="line">	<span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> m,p,x,a=<span class="number">0</span>,n=<span class="number">0</span>;</span><br><span class="line">	cin&gt;&gt;m&gt;&gt;p;</span><br><span class="line">	<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,m);</span><br><span class="line">	<span class="keyword">while</span>(m--)&#123;</span><br><span class="line">		<span class="type">char</span> c;</span><br><span class="line">		cin&gt;&gt;c&gt;&gt;x;</span><br><span class="line">		<span class="keyword">if</span>(c==<span class="string">&#x27;A&#x27;</span>)&#123;</span><br><span class="line">			x=(x+a)%p;</span><br><span class="line">			<span class="built_in">add</span>(<span class="number">1</span>,++n,x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			a=<span class="built_in">query</span>(<span class="number">1</span>,n-x+<span class="number">1</span>,n);</span><br><span class="line">			cout&lt;&lt;a&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä½ èƒ½å›ç­”è¿™äº›é—®é¢˜å—"><a href="#ä½ èƒ½å›ç­”è¿™äº›é—®é¢˜å—" class="headerlink" title="ä½ èƒ½å›ç­”è¿™äº›é—®é¢˜å—"></a><a href="https://www.acwing.com/problem/content/description/246/">ä½ èƒ½å›ç­”è¿™äº›é—®é¢˜å—</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šé•¿åº¦ä¸º N çš„æ•°åˆ— Aï¼Œä»¥åŠ M æ¡æŒ‡ä»¤ï¼Œæ¯æ¡æŒ‡ä»¤å¯èƒ½æ˜¯ä»¥ä¸‹ä¸¤ç§ä¹‹ä¸€ï¼š</p>
<ol>
<li><code>1 x y</code>ï¼ŒæŸ¥è¯¢åŒºé—´ [x,y] ä¸­çš„æœ€å¤§è¿ç»­å­æ®µå’Œã€‚</li>
<li><code>2 x y</code>ï¼ŒæŠŠ A[x] æ”¹æˆ yã€‚</li>
</ol>
<p>å¯¹äºæ¯ä¸ªæŸ¥è¯¢æŒ‡ä»¤ï¼Œè¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„ä»å³ç«¯å¼€å§‹çš„æœ€å¤§è¿ç»­å­—æ®µå’Œï¼Œä»å·¦ç«¯å¼€å§‹çš„æœ€å¤§è¿ç»­å­—æ®µå’Œï¼Œä»è€Œè¿›è¡Œæ¯”è¾ƒï¼Œå†é€šè¿‡å°†å·¦å­æ ‘çš„å³ç«¯å¼€å§‹çš„æœ€å¤§è¿ç»­å­—æ®µå’Œ + å³å­æ ‘çš„å·¦ç«¯å¼€å§‹çš„æœ€å¤§è¿ç»­å­—æ®µå’Œ çš„å€¼ä»¥åŠå·¦å³å­æ ‘çš„åŒºé—´å†…æœ€å¤§è¿ç»­å­—æ®µå’Œå¾—åˆ°çˆ¶èŠ‚ç‚¹çš„åŒºé—´å†…æœ€å¤§è¿ç»­å­—æ®µå’Œã€‚</p>
<p><strong>ç­”æ¡ˆ</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r,sum;		<span class="comment">//wè¡¨ç¤ºæ‰€æœ‰</span></span><br><span class="line">	<span class="type">int</span> lmax,rmax,tmax;	</span><br><span class="line">&#125;tr[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(node &amp;u,node &amp;l,node &amp;r)</span></span>&#123;</span><br><span class="line">	u.sum=l.sum+r.sum;</span><br><span class="line">	u.lmax=<span class="built_in">max</span>(l.lmax,l.sum+r.lmax);</span><br><span class="line">	u.rmax=<span class="built_in">max</span>(r.rmax,r.sum+l.rmax);</span><br><span class="line">	u.tmax=<span class="built_in">max</span>(l.rmax+r.lmax,<span class="built_in">max</span>(l.tmax,r.tmax));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="built_in">pushup</span>(tr[u],tr[u&lt;&lt;<span class="number">1</span>],tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	tr[u]=&#123;l,r,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">if</span>(l==r)tr[u]=&#123;l,r,a[l],a[l],a[l],a[l]&#125;;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">		<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> p,<span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l==p&amp;&amp;tr[u].r==p)tr[u]=&#123;p,p,w,w,w,w&#125;;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="type">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(mid&gt;=p)<span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>,p,w);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,p,w);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">node <span class="title">query</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)<span class="keyword">return</span> tr[u];</span><br><span class="line">	<span class="type">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(mid&lt;l)<span class="keyword">return</span> <span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(mid&gt;=r)<span class="keyword">return</span> <span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">auto</span> left=<span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">		<span class="keyword">auto</span> right=<span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">		node res;</span><br><span class="line">		<span class="built_in">pushup</span>(res,left,right);</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> n,q;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)cin&gt;&gt;a[i];</span><br><span class="line">	<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">	<span class="keyword">while</span>(q--)&#123;</span><br><span class="line">		<span class="type">int</span> k,x,y;</span><br><span class="line">		cin&gt;&gt;k&gt;&gt;x&gt;&gt;y;</span><br><span class="line">		<span class="keyword">if</span>(k==<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(x&gt;y)<span class="built_in">swap</span>(x,y);</span><br><span class="line">			<span class="keyword">auto</span> ans=<span class="built_in">query</span>(<span class="number">1</span>,x,y);</span><br><span class="line">			cout&lt;&lt;ans.tmax&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">modify</span>(<span class="number">1</span>,x,y);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ•Œå…µå¸ƒé˜µ"><a href="#æ•Œå…µå¸ƒé˜µ" class="headerlink" title="æ•Œå…µå¸ƒé˜µ"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1166">æ•Œå…µå¸ƒé˜µ</a></h2><p>ç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•°Tï¼Œè¡¨ç¤ºæœ‰Tç»„æ•°æ®ã€‚<br>æ¯ç»„æ•°æ®ç¬¬ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•°Nï¼ˆN&lt;&#x3D;50000ï¼‰,è¡¨ç¤ºæ•Œäººæœ‰Nä¸ªå·¥å…µè¥åœ°ï¼Œæ¥ä¸‹æ¥æœ‰Nä¸ªæ­£æ•´æ•°,ç¬¬iä¸ªæ­£æ•´æ•°aiä»£è¡¨ç¬¬iä¸ªå·¥å…µè¥åœ°é‡Œå¼€å§‹æ—¶æœ‰aiä¸ªäººï¼ˆ1&lt;&#x3D;ai&lt;&#x3D;50ï¼‰ã€‚<br>æ¥ä¸‹æ¥æ¯è¡Œæœ‰ä¸€æ¡å‘½ä»¤ï¼Œå‘½ä»¤æœ‰4ç§å½¢å¼ï¼š<br>(1) Add i j,iå’Œjä¸ºæ­£æ•´æ•°,è¡¨ç¤ºç¬¬iä¸ªè¥åœ°å¢åŠ jä¸ªäººï¼ˆjä¸è¶…è¿‡30ï¼‰<br>(2)Sub i j ,iå’Œjä¸ºæ­£æ•´æ•°,è¡¨ç¤ºç¬¬iä¸ªè¥åœ°å‡å°‘jä¸ªäººï¼ˆjä¸è¶…è¿‡30ï¼‰;<br>(3)Query i j ,iå’Œjä¸ºæ­£æ•´æ•°,i&lt;&#x3D;jï¼Œè¡¨ç¤ºè¯¢é—®ç¬¬iåˆ°ç¬¬jä¸ªè¥åœ°çš„æ€»äººæ•°;<br>(4)End è¡¨ç¤ºç»“æŸï¼Œè¿™æ¡å‘½ä»¤åœ¨æ¯ç»„æ•°æ®æœ€åå‡ºç°;<br>æ¯ç»„æ•°æ®æœ€å¤šæœ‰40000æ¡å‘½ä»¤</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mxn=<span class="number">5e4</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    <span class="type">int</span> l,r,sum;</span><br><span class="line">&#125;t[mxn*<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> a[mxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">    t[u].l=l,t[u].r=r;</span><br><span class="line">    <span class="keyword">if</span>(l==r)<span class="keyword">return</span> t[u].sum=a[l];    <span class="comment">//åŒºé—´å†…åªæœ‰ä¸€ä¸ªæ•°ä¸èƒ½å†åˆ†</span></span><br><span class="line">    <span class="keyword">return</span> t[u].sum=<span class="built_in">build</span>(l,l+r&gt;&gt;<span class="number">1</span>,u&lt;&lt;<span class="number">1</span>)+<span class="built_in">build</span>((l+r&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>,r,(u&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        t[u].sum+=num;    <span class="comment">//çˆ¶èŠ‚ç‚¹çš„å€¼å¢åŠ </span></span><br><span class="line">        <span class="keyword">if</span>(t[u].l==t[u].r&amp;&amp;t[u].l==i)<span class="keyword">break</span>;    <span class="comment">//åˆ°è¾¾å­èŠ‚ç‚¹åˆ™é€€å‡º</span></span><br><span class="line">        <span class="keyword">if</span>((t[u].l+t[u].r&gt;&gt;<span class="number">1</span>)&gt;=i)u=u&lt;&lt;<span class="number">1</span>;    <span class="comment">//åˆ¤æ–­ièŠ‚ç‚¹çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">else</span> u=(u&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> u=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        t[u].sum-=num;</span><br><span class="line">        <span class="keyword">if</span>(t[u].l==t[u].r&amp;&amp;t[u].l==i)<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span>((t[u].l+t[u].r&gt;&gt;<span class="number">1</span>)&gt;=i)u=u&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> u=(u&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;r||t[u].l&gt;r||t[u].r&lt;l)<span class="keyword">return</span> <span class="number">0</span>;    <span class="comment">//æ‰€é€‰åŒºé—´ä¸å­˜åœ¨æˆ–è€…åœ¨è¿™é¢—æ ‘çš„æœ€å¤§åŒºé—´å¤–è¿”å›0</span></span><br><span class="line">    <span class="keyword">if</span>(t[u].l&gt;=l&amp;&amp;t[u].r&lt;=r)<span class="keyword">return</span> t[u].sum;    <span class="comment">//å¦‚æœæ‰€é€‰æ ‘åŒºé—´æ‰€æ‰¾èŒƒå›´å†…è¿”å›å®ƒçš„å€¼</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">query</span>(l,r,u&lt;&lt;<span class="number">1</span>)+<span class="built_in">query</span>(l,r,(u&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>);    <span class="comment">//å°†æ‰€æ‰¾èŒƒå›´å†…çš„æ‰€æœ‰æ ‘åŒºé—´çš„å€¼ç›¸åŠ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T,n,tot,u,v;</span><br><span class="line">string s;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        cin&gt;&gt;n;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;Case &quot;</span>&lt;&lt;++tot&lt;&lt;<span class="string">&quot;:\n&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)cin&gt;&gt;a[i];</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>,n,<span class="number">1</span>);    <span class="comment">//å»ºæ ‘</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            cin&gt;&gt;s;</span><br><span class="line">            <span class="keyword">if</span>(s[<span class="number">0</span>]==<span class="string">&#x27;E&#x27;</span>)<span class="keyword">break</span>;</span><br><span class="line">            cin&gt;&gt;u&gt;&gt;v;</span><br><span class="line">            <span class="keyword">if</span>(s[<span class="number">0</span>]==<span class="string">&#x27;Q&#x27;</span>)cout&lt;&lt;<span class="built_in">query</span>(u,v,<span class="number">1</span>)&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">0</span>]==<span class="string">&#x27;A&#x27;</span>)<span class="built_in">add</span>(u,v);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">0</span>]==<span class="string">&#x27;S&#x27;</span>)<span class="built_in">sub</span>(u,v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åŒºé—´æœ€å¤§å…¬çº¦æ•°"><a href="#åŒºé—´æœ€å¤§å…¬çº¦æ•°" class="headerlink" title="åŒºé—´æœ€å¤§å…¬çº¦æ•°"></a><a href="https://www.acwing.com/problem/content/247/">åŒºé—´æœ€å¤§å…¬çº¦æ•°</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º N çš„æ•°åˆ— Aï¼Œä»¥åŠ M æ¡æŒ‡ä»¤ï¼Œæ¯æ¡æŒ‡ä»¤å¯èƒ½æ˜¯ä»¥ä¸‹ä¸¤ç§ä¹‹ä¸€ï¼š</p>
<ol>
<li><code>C l r d</code>ï¼Œè¡¨ç¤ºæŠŠ A[l],A[l+1],â€¦,A[r] éƒ½åŠ ä¸Š dã€‚</li>
<li><code>Q l r</code>ï¼Œè¡¨ç¤ºè¯¢é—® A[l],A[l+1],â€¦,A[r] çš„æœ€å¤§å…¬çº¦æ•°(GCD)ã€‚</li>
</ol>
<p>å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œè¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>å•ç‚¹åŠ å€¼å¥½åŠ ï¼Œæ‰€ä»¥ç”¨å‰ç¼€å’Œå­˜å‚¨</p>
<p>gcd(aâˆ’nb,b)&#x3D;gcd(a,b)</p>
<p>(a,b,c)&#x3D;((a,b),(b,c))&#x3D;((a,bâˆ’a),(b,câˆ’b))&#x3D;(a,bâˆ’a,b,câˆ’b)</p>
<p>ç”±äº(bâˆ’a,b)&#x3D;(a,bâˆ’a),æ‰€ä»¥(a,b,c)&#x3D;(a,bâˆ’a,câˆ’b)</p>
<p>æ‰€ä»¥è¦æ±‚åŒºé—´[L,R]çš„æœ€å¤§å…¬çº¦æ•°åªè¦æ±‚å‡ºa[L]å’Œ(a[L+1]-a[L],a[L+2]-a[L+1],â€¦,a[R]-a[R-1])</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> ll N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line">ll s[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	ll l,r,w,d;</span><br><span class="line">&#125;tr[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(node &amp;u,node &amp;l,node &amp;r)</span></span>&#123;</span><br><span class="line">	u.w=l.w+r.w;</span><br><span class="line">	u.d=<span class="built_in">gcd</span>(l.d,r.d);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(ll u)</span></span>&#123;</span><br><span class="line">	<span class="built_in">pushup</span>(tr[u],tr[u&lt;&lt;<span class="number">1</span>],tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(ll u,ll l,ll r)</span></span>&#123;</span><br><span class="line">	tr[u]=&#123;l,r,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">		ll m=s[l]-s[l<span class="number">-1</span>];</span><br><span class="line">		tr[u]=&#123;l,r,m,m&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		ll mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">		<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(ll u,ll p,ll w)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l==tr[u].r&amp;&amp;tr[u].l==p)&#123;</span><br><span class="line">		ll m=tr[u].w+w;</span><br><span class="line">		tr[u]=&#123;p,p,m,m&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		ll mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(p&lt;=mid)<span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>,p,w);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,p,w);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">node <span class="title">query</span><span class="params">(ll u,ll l,ll r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l&gt;r)<span class="keyword">return</span> &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)<span class="keyword">return</span> tr[u];</span><br><span class="line">	ll mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(mid&lt;l)<span class="keyword">return</span> <span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(mid&gt;=r)<span class="keyword">return</span> <span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">auto</span> left=<span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">		<span class="keyword">auto</span> right=<span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">		node res;</span><br><span class="line">		<span class="built_in">pushup</span>(res,left,right);</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll n,q;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">	<span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		cin&gt;&gt;s[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">	<span class="keyword">while</span>(q--)&#123;</span><br><span class="line">		<span class="type">char</span> c;</span><br><span class="line">		ll x,y,d;</span><br><span class="line">		cin&gt;&gt;c;</span><br><span class="line">		<span class="keyword">if</span>(c==<span class="string">&#x27;Q&#x27;</span>)&#123;</span><br><span class="line">			cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">			<span class="keyword">auto</span> left=<span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,x);</span><br><span class="line">			<span class="keyword">auto</span> right=<span class="built_in">query</span>(<span class="number">1</span>,x+<span class="number">1</span>,y);</span><br><span class="line">			cout&lt;&lt;<span class="built_in">abs</span>(<span class="built_in">gcd</span>(left.w,right.d))&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			cin&gt;&gt;x&gt;&gt;y&gt;&gt;d;</span><br><span class="line">			<span class="built_in">modify</span>(<span class="number">1</span>,x,d);</span><br><span class="line">			<span class="keyword">if</span>(y+<span class="number">1</span>&lt;=n)<span class="built_in">modify</span>(<span class="number">1</span>,y+<span class="number">1</span>,-d);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2-1"><a href="#ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2-1" class="headerlink" title="ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2"></a><a href="https://www.acwing.com/problem/content/244/">ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º N çš„æ•°åˆ— Aï¼Œä»¥åŠ M æ¡æŒ‡ä»¤ï¼Œæ¯æ¡æŒ‡ä»¤å¯èƒ½æ˜¯ä»¥ä¸‹ä¸¤ç§ä¹‹ä¸€ï¼š</p>
<ol>
<li><code>C l r d</code>ï¼Œè¡¨ç¤ºæŠŠ A[l],A[l+1],â€¦,A[r] éƒ½åŠ ä¸Š dã€‚</li>
<li><code>Q l r</code>ï¼Œè¡¨ç¤ºè¯¢é—®æ•°åˆ—ä¸­ç¬¬ lâˆ¼r ä¸ªæ•°çš„å’Œã€‚</li>
</ol>
<p>å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œè¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>æ‡’æ ‡è®°ï¼Œå­˜å‚¨åŒºé—´å†…éœ€è¦åŠ çš„å€¼ï¼ŒåŒºé—´å†…åŠ å€¼ï¼Œå…ˆåŠ åˆ°çˆ¶èŠ‚ç‚¹ä¸Šå¯ä»¥å‡å°‘è¿è¡Œæ—¶é—´ï¼ŒæŸ¥è¯¢ã€æ·»åŠ çš„æ—¶å€™å…ˆå‘ä¸‹éå†ï¼Œæ·»åŠ ç»“æŸåå‘ä¸Šéå†å°†çˆ¶èŠ‚ç‚¹çš„æ€»å’Œå€¼å¢åŠ ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r,w,add;</span><br><span class="line">&#125;tr[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(node &amp;u,node &amp;l,node &amp;r)</span></span>&#123;</span><br><span class="line">	u.w=l.w+r.w;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="built_in">pushup</span>(tr[u],tr[u&lt;&lt;<span class="number">1</span>],tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(node &amp;u,node &amp;l,node &amp;r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(u.add)&#123;</span><br><span class="line">		l.add+=u.add,l.w+=(l.r-l.l+<span class="number">1</span>)*u.add;</span><br><span class="line">		r.add+=u.add,r.w+=(r.r-r.l+<span class="number">1</span>)*u.add;</span><br><span class="line">		u.add=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="built_in">pushdown</span>(tr[u],tr[u&lt;&lt;<span class="number">1</span>],tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l==r)tr[u]=&#123;l,r,a[l],<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		tr[u]=&#123;l,r,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">		<span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">		<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)<span class="keyword">return</span> tr[u].w;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">pushdown</span>(u);</span><br><span class="line">		<span class="type">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>,v=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(l&lt;=mid)v=<span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">		<span class="keyword">if</span>(r&gt;mid)v+=<span class="built_in">query</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">		<span class="keyword">return</span> v;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)&#123;</span><br><span class="line">		tr[u].w+=(tr[u].r-tr[u].l+<span class="number">1</span>)*d;</span><br><span class="line">		tr[u].add+=d;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">pushdown</span>(u);</span><br><span class="line">		<span class="type">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(l&lt;=mid)<span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>,l,r,d);</span><br><span class="line">		<span class="keyword">if</span>(r&gt;mid)<span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,d);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> n,q;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)cin&gt;&gt;a[i];</span><br><span class="line">	<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">	<span class="keyword">while</span>(q--)&#123;</span><br><span class="line">		<span class="type">char</span> c;</span><br><span class="line">		<span class="type">int</span> x,y,d;</span><br><span class="line">		cin&gt;&gt;c;</span><br><span class="line">		<span class="keyword">if</span>(c==<span class="string">&#x27;Q&#x27;</span>)&#123;</span><br><span class="line">			cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">			cout&lt;&lt;<span class="built_in">query</span>(<span class="number">1</span>,x,y)&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			cin&gt;&gt;x&gt;&gt;y&gt;&gt;d;</span><br><span class="line">			<span class="built_in">modify</span>(<span class="number">1</span>,x,y,d);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="æ‰«æçº¿"><a href="#æ‰«æçº¿" class="headerlink" title="æ‰«æçº¿"></a>æ‰«æçº¿</h1><p>ç°åœ¨å‡è®¾æˆ‘ä»¬æœ‰ä¸€æ ¹çº¿ï¼Œä»ä¸‹å¾€ä¸Šå¼€å§‹æ‰«æï¼š</p>
<p><img src="https://oi-wiki.org/geometry/images/scanning.svg" alt="img"></p>
<ul>
<li>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªçŸ©å½¢åˆ†æˆå¦‚å›¾å„ä¸ªé¢œè‰²ä¸åŒçš„å°çŸ©å½¢ï¼Œé‚£ä¹ˆè¿™ä¸ªå°çŸ©å½¢çš„é«˜å°±æ˜¯æˆ‘ä»¬æ‰«è¿‡çš„è·ç¦»ï¼Œé‚£ä¹ˆå‰©ä¸‹äº†ä¸€ä¸ªå˜é‡ï¼Œé‚£å°±æ˜¯çŸ©å½¢çš„é•¿ä¸€ç›´åœ¨å˜åŒ–ã€‚</li>
<li>æˆ‘ä»¬çš„çº¿æ®µæ ‘å°±æ˜¯ä¸ºäº†ç»´æŠ¤çŸ©å½¢çš„é•¿ï¼Œæˆ‘ä»¬ç»™æ¯ä¸€ä¸ªçŸ©å½¢çš„ä¸Šä¸‹è¾¹è¿›è¡Œæ ‡è®°ï¼Œä¸‹é¢çš„è¾¹æ ‡è®°ä¸º 1ï¼Œä¸Šé¢çš„è¾¹æ ‡è®°ä¸º -1ï¼Œæ¯é‡åˆ°ä¸€ä¸ªçŸ©å½¢æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“äº†æ ‡è®°ä¸º 1 çš„è¾¹ï¼Œæˆ‘ä»¬å°±åŠ è¿›æ¥è¿™ä¸€æ¡çŸ©å½¢çš„é•¿ï¼Œç­‰åˆ°æ‰«æåˆ° -1 æ—¶ï¼Œè¯æ˜è¿™ä¸€æ¡è¾¹éœ€è¦åˆ é™¤ï¼Œå°±åˆ å»ï¼Œåˆ©ç”¨ 1 å’Œ -1 å¯ä»¥è½»æ¾çš„åˆ°è¿™ç§çŠ¶æ€ã€‚</li>
<li>è¿˜è¦æ³¨æ„è¿™é‡Œçš„çº¿æ®µæ ‘æŒ‡çš„å¹¶ä¸æ˜¯çº¿æ®µçš„ä¸€ä¸ªç«¯ç‚¹ï¼Œè€ŒæŒ‡çš„æ˜¯ä¸€ä¸ªåŒºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯ r+1 å’Œ r-1ã€‚</li>
<li>éœ€è¦ <a href="https://oi-wiki.org/misc/discrete/">ç¦»æ•£åŒ–</a>ã€‚</li>
</ul>
<h2 id="äºšç‰¹å…°è’‚æ–¯"><a href="#äºšç‰¹å…°è’‚æ–¯" class="headerlink" title="äºšç‰¹å…°è’‚æ–¯"></a><a href="https://www.acwing.com/problem/content/249/">äºšç‰¹å…°è’‚æ–¯</a></h2><p><strong>é¢˜ç›®</strong></p>
<p>æœ‰å‡ ä¸ªå¤å¸Œè…Šä¹¦ç±ä¸­åŒ…å«äº†å¯¹ä¼ è¯´ä¸­çš„äºšç‰¹å…°è’‚æ–¯å²›çš„æè¿°ã€‚</p>
<p>å…¶ä¸­ä¸€äº›ç”šè‡³åŒ…æ‹¬å²›å±¿éƒ¨åˆ†åœ°å›¾ã€‚</p>
<p>ä½†ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›åœ°å›¾æè¿°äº†äºšç‰¹å…°è’‚æ–¯çš„ä¸åŒåŒºåŸŸã€‚</p>
<p>æ‚¨çš„æœ‹å‹ Bill å¿…é¡»çŸ¥é“åœ°å›¾çš„æ€»é¢ç§¯ã€‚</p>
<p>ä½ è‡ªå‘Šå¥‹å‹‡å†™äº†ä¸€ä¸ªè®¡ç®—è¿™ä¸ªæ€»é¢ç§¯çš„ç¨‹åºã€‚</p>
<p><strong>æ€è·¯</strong></p>
<p>ç”¨vectorç¦»æ•£åŒ–ç»™å‡ºçš„æ‰€æœ‰çš„yåæ ‡ï¼Œä¿è¯æ¯ä¸ªåæ ‡éƒ½æœ‰ä¸€ä¸ªç¼–å·ã€‚</p>
<p>ä»xåæ ‡å·¦ç«¯å‘å³è¾¹éå†ï¼Œæ¯æ¬¡æ·»åŠ ä¸€æ¡åæ ‡xä¸Šçš„è¾¹ï¼Œå¦‚æœè¯¥è¾¹æ˜¯å¼€å§‹ï¼Œåˆ™é«˜åº”è¯¥ç­‰äºè¯¥è¾¹çš„é•¿åº¦ - ä¸å·²ç»åŒ…å«åœ¨å†…çš„è¾¹çš„é‡å éƒ¨åˆ†ï¼›å¦‚æœè¯¥è¾¹æ˜¯ç»“æŸï¼Œåˆ™åº”è¯¥å°†åŒ…å«åœ¨å†…çš„è¾¹å‡å»è¿™æ¡è¾¹æ‰€ç»™çš„è´¡çŒ®ã€‚ç»“æœå°±æ˜¯è¿™æ¡è¾¹ä¸ä¸Šä¸€æ¡åŠ è¿›å»çš„è¾¹çš„xè½´åæ ‡è·ç¦» * é«˜ã€‚</p>
<p>çº¿æ®µæ ‘å­˜å‚¨çš„æ˜¯æ‰€æœ‰åŠ è¿›å»çš„yçº¿æ®µçš„é•¿åº¦ï¼Œæ‰€ä»¥tr[1]ä¿å­˜çš„å°±æ˜¯æ€»é•¿</p>
<p>å› ä¸ºyçš„èŒƒå›´å¤ªå¤§ï¼Œnæ€»æ•°æ‰100ï¼Œæ‰€ä»¥éœ€è¦ç¦»æ•£åŒ–ï¼Œæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨ä¸€ä¸ªé•¿åº¦ï¼Œæ‰€ä»¥å»ºæ ‘çš„æ—¶å€™æ€»æ•°åº”è¯¥å‡1ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ing long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">	<span class="type">double</span> x,y1,y2;</span><br><span class="line">	<span class="type">int</span> d;</span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node&amp;b)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> x&lt;b.x;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;s[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="type">double</span>&gt;v;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node2</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r;</span><br><span class="line">	<span class="type">int</span> cnt;</span><br><span class="line">	<span class="type">double</span> w;</span><br><span class="line">&#125;tr[N&lt;&lt;<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	tr[u]=&#123;l,r,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">if</span>(l==r)<span class="keyword">return</span>;</span><br><span class="line">	<span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">	<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].cnt)</span><br><span class="line">		tr[u].w=v[tr[u].r+<span class="number">1</span>]-v[tr[u].l];</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		tr[u].w=tr[u&lt;&lt;<span class="number">1</span>].w+tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)&#123;</span><br><span class="line">		tr[u].cnt+=d;</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="type">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(l&lt;=mid)<span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>,l,r,d);</span><br><span class="line">		<span class="keyword">if</span>(r&gt;mid)<span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,d);</span><br><span class="line">		<span class="built_in">pushup</span>(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">double</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),y)-v.<span class="built_in">begin</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>),cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> n,t=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(cin&gt;&gt;n,n)&#123;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;Test case #&quot;</span>&lt;&lt;++t&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">		<span class="type">int</span> tot=<span class="number">0</span>;</span><br><span class="line">		v.<span class="built_in">clear</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">			<span class="type">double</span> xx1,yy1,xx2,yy2;</span><br><span class="line">			cin&gt;&gt;xx1&gt;&gt;yy1&gt;&gt;xx2&gt;&gt;yy2; </span><br><span class="line">			s[++tot]=&#123;xx1,yy1,yy2,<span class="number">1</span>&#125;;</span><br><span class="line">			s[++tot]=&#123;xx2,yy1,yy2,<span class="number">-1</span>&#125;;</span><br><span class="line">			v.<span class="built_in">push_back</span>(yy1);</span><br><span class="line">			v.<span class="built_in">push_back</span>(yy2);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(s+<span class="number">1</span>,s+tot+<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line">		v.<span class="built_in">erase</span>(<span class="built_in">unique</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>()),v.<span class="built_in">end</span>());</span><br><span class="line">		<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">0</span>,v.<span class="built_in">size</span>()<span class="number">-2</span>);</span><br><span class="line">		<span class="type">double</span> res=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i&gt;<span class="number">1</span>)res+=(s[i].x-s[i<span class="number">-1</span>].x)*tr[<span class="number">1</span>].w;</span><br><span class="line">			<span class="built_in">modify</span>(<span class="number">1</span>,<span class="built_in">find</span>(s[i].y1),<span class="built_in">find</span>(s[i].y2)<span class="number">-1</span>,s[i].d);</span><br><span class="line">		&#125;</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot;Total explored area: &quot;</span>&lt;&lt;fixed&lt;&lt;<span class="built_in">setprecision</span>(<span class="number">2</span>)&lt;&lt;res&lt;&lt;<span class="string">&#x27;\n&#x27;</span>&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
</search>
